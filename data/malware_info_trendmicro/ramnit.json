{
    "name": "ramnit",
    "content": [
        {
            "summary": "Infection Channel:  Downloaded from the Internet, Infects filesRAMNIT is a multi-component malware that infects .DLL, .EXE, and HTML files. This malware family is known to propagate via removable drives.RAMNIT steals sensitive information such as saved FTP credentials and browser cookies. It does this routine by querying the infected system's registry information to get the user's default browser.It may also open ports to allow backdoor connections to the affected computer. RAMNIT then waits for instructions from a remote attacker.",
            "tech": "Memory Resident:  YesPayload:  Compromises system security, Steals informationInstallationThis file infector  drops the following files: %Application Data%\\{random}\\{random}.exe%Program Files%\\Microsoft\\WaterMark.exe%Program Files%\\{random}\\{random}.exe%User Startup%\\{random}.exe%User Temp%\\{random}.exe{folder where malware is located}\\{malware name}mgr.exe(Note: %Application Data% is the current user's Application Data folder, which is usually C:\\Documents and Settings\\{user name}\\Application Data on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name}\\AppData\\Roaming on Windows Vista and 7.. %Program Files% is the default Program Files folder, usually C:\\Program Files in Windows 2000, Server 2003, and XP (32-bit), Vista (32-bit), and 7 (32-bit), or C:\\Program Files (x86) in Windows XP (64-bit), Vista (64-bit), and 7 (64-bit).. %User Startup% is the current user's Startup folder, which is usually C:\\Windows\\Profiles\\{user name}\\Start Menu\\Programs\\Startup on Windows 98 and ME, C:\\WINNT\\Profiles\\{user name}\\Start Menu\\Programs\\Startup on Windows NT, and C:\\Documents and Settings\\{User name}\\Start Menu\\Programs\\Startup.. %User Temp% is the current user's Temp folder, which is usually C:\\Documents and Settings\\{user name}\\Local Settings\\Temp on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name}\\AppData\\Local\\Temp on Windows Vista and 7.)It drops the following file(s)/component(s): %Application Data%\\{random}.log%Program Files%\\Internet Explorer\\dmlconf.dat%User Profile%\\{random}.log%User Temp%\\{random}.sys{drive letter}:\\Copy of {number}.lnk{drive letter}:\\RECYCLER\\{SID}\\{random}.cpl{drive letter}:\\autorun.inf(Note: %Application Data% is the current user's Application Data folder, which is usually C:\\Documents and Settings\\{user name}\\Application Data on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name}\\AppData\\Roaming on Windows Vista and 7.. %Program Files% is the default Program Files folder, usually C:\\Program Files in Windows 2000, Server 2003, and XP (32-bit), Vista (32-bit), and 7 (32-bit), or C:\\Program Files (x86) in Windows XP (64-bit), Vista (64-bit), and 7 (64-bit).. %User Profile% is the current user's profile folder, which is usually C:\\Documents and Settings\\{user name} on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name} on Windows Vista and 7.. %User Temp% is the current user's Temp folder, which is usually C:\\Documents and Settings\\{user name}\\Local Settings\\Temp on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name}\\AppData\\Local\\Temp on Windows Vista and 7.)It creates the following folders: %Application Data%\\{random}%Program Files%\\{random}{drive letter}:\\RECYCLER(Note: %Application Data% is the current user's Application Data folder, which is usually C:\\Documents and Settings\\{user name}\\Application Data on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name}\\AppData\\Roaming on Windows Vista and 7.. %Program Files% is the default Program Files folder, usually C:\\Program Files in Windows 2000, Server 2003, and XP (32-bit), Vista (32-bit), and 7 (32-bit), or C:\\Program Files (x86) in Windows XP (64-bit), Vista (64-bit), and 7 (64-bit).)Autostart TechniqueThis file infector  registers itself as a system service to ensure its automatic execution at every system startup by adding the following registry entries: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nType = \"1\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nStart = \"4\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nErrorControl = \"0\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nDisplayName = \"Micorsoft Windows Service\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nDeleteFlag = \"1\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nImagePath = \"%Application Data%\\{random}\\{random}.sys\"It adds the following registry entries to enable its automatic execution at every system startup: HKEY_CURRENT_USER\\Software\\Microsoft\\\nWindows\\CurrentVersion\\Run\n{random}  = \"%Application Data%\\{random}\\{random}.exe\"Other System ModificationsThis file infector  adds the following registry entries as part of its installation routine: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\SharedAccess\\Parameters\\\nFirewallPolicy\\StandardProfile\\AuthorizedApplications\\\nList\n%Program Files%\\Internet Explorer\\IEXPLORE.EXE  = \"%Program Files%\\Internet Explorer\\IEXPLORE.EXE:*:Enabled:internet Explorer\"It modifies the following registry entries: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows NT\\CurrentVersion\\Winlogon\nUserinit = \"%System%\\userinit.exe,%Application Data%\\{random}\\{random}.exe\"(Note: The default value data of the said registry entry is %System%\\userinit.exe,.)HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows NT\\CurrentVersion\\Winlogon\nUserinit  = \"%System%\\userinit.exe,%Program Files%\\{random}\\{random}.exe\"(Note: The default value data of the said registry entry is %System%\\userinit.exe,.)It deletes the following registry keys: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nControl\\SafeBoot\\MinimalHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nControl\\SafeBoot\\NetworkOther DetailsThis file infector  connects to the following possibly malicious URL: {BLOCKED}.{BLOCKED}.6.203 ",
            "solution": ""
        },
        {
            "summary": "\u611f\u67d3\u7ba1\u9053\uff1a\u5f9e\u4e92\u806f\u7db2\u4e0a\u4e0b\u8f09",
            "tech": "\u8a18\u61b6\u9ad4\u5e38\u99d0\u578b\uff1a Yes\u5b89\u88dd\u5b83\u6703\u653e\u7f6e\u4e0b\u5217\u6a94\u6848\uff1a%Application Data%\\{random}\\{random}.exe%Program Files%\\Microsoft\\WaterMark.exe%Program Files%\\{random}\\{random}.exe%User Startup%\\{random}.exe%User Temp%\\{random}.exe{folder where malware is located}\\{malware name}mgr.exe(\u6ce8\u610f\uff1a%Application Data% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684 Application Data \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Windows\\Profiles\\{user name}\\Application Data\uff08Windows 98 \u548c ME\uff09\u3001C:\\WINNT\\Profiles\\{user name}\\Application Data (Windows NT)\uff0c\u4ee5\u53ca C:\\Documents and Settings\\{user name}\\Local Settings\\Application Data\uff08Windows 2000\u3001XP \u548c Server 2003\uff09\u3002. %Program Files% \u662f\u9810\u8a2d\u7684 Program Files \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Program Files\u3002. %User Startup% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684\u300c\u555f\u52d5\u300d\u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Windows\\Profiles\\{user name}\\\u300c\u958b\u59cb\u300d\u529f\u80fd\u8868\\\u7a0b\u5f0f\u96c6\\\u555f\u52d5\uff08Windows 98 \u548c ME\uff09\u3001C:\\WINNT\\Profiles\\{user name}\\\u300c\u958b\u59cb\u300d\u529f\u80fd\u8868\\\u7a0b\u5f0f\u96c6\\\u555f\u52d5 (Windows NT)\uff0c\u4ee5\u53ca C:\\Documents and Settings\\{User name}\\\u300c\u958b\u59cb\u300d\u529f\u80fd\u8868\\\u7a0b\u5f0f\u96c6\\\u555f\u52d5\u3002. %User Temp% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684 Temp \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Documents and Settings\\{user name}\\Local Settings\\Temp\uff08Windows 2000\u3001XP \u548c Server 2003\uff09\u3002)\u5b83\u6703\u653e\u7f6e\u4e0b\u5217\u6a94\u6848\u5143\u4ef6\uff1a%Application Data%\\{random}.log%Program Files%\\Internet Explorer\\dmlconf.dat%User Profile%\\{random}.log%User Temp%\\{random}.sys{drive letter}:\\Copy of {number}.lnk{drive letter}:\\RECYCLER\\{SID}\\{random}.cpl{drive letter}:\\autorun.inf(\u6ce8\u610f\uff1a%Application Data% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684 Application Data \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Windows\\Profiles\\{user name}\\Application Data\uff08Windows 98 \u548c ME\uff09\u3001C:\\WINNT\\Profiles\\{user name}\\Application Data (Windows NT)\uff0c\u4ee5\u53ca C:\\Documents and Settings\\{user name}\\Local Settings\\Application Data\uff08Windows 2000\u3001XP \u548c Server 2003\uff09\u3002. %Program Files% \u662f\u9810\u8a2d\u7684 Program Files \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Program Files\u3002. %User Profile% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684\u8a2d\u5b9a\u6a94\u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Windows\\Profiles\\{user name}\uff08Windows 98 \u548c ME\uff09\u3001C:\\WINNT\\Profiles\\{user name} (Windows NT)\uff0c\u4ee5\u53ca C:\\Documents and Settings\\{user name}\uff08Windows 2000\u3001XP \u548c Server 2003\uff09\u3002. %User Temp% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684 Temp \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Documents and Settings\\{user name}\\Local Settings\\Temp\uff08Windows 2000\u3001XP \u548c Server 2003\uff09\u3002)\u5b83\u6703\u5efa\u7acb\u4e0b\u5217\u8cc7\u6599\u593e\uff1a%Application Data%\\{random}%Program Files%\\{random}{drive letter}:\\RECYCLER(\u6ce8\u610f\uff1a%Application Data% \u662f\u76ee\u524d\u4f7f\u7528\u8005\u7684 Application Data \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Windows\\Profiles\\{user name}\\Application Data\uff08Windows 98 \u548c ME\uff09\u3001C:\\WINNT\\Profiles\\{user name}\\Application Data (Windows NT)\uff0c\u4ee5\u53ca C:\\Documents and Settings\\{user name}\\Local Settings\\Application Data\uff08Windows 2000\u3001XP \u548c Server 2003\uff09\u3002. %Program Files% \u662f\u9810\u8a2d\u7684 Program Files \u8cc7\u6599\u593e\uff0c\u901a\u5e38\u662f C:\\Program Files\u3002)\u81ea\u52d5\u555f\u52d5\u6280\u8853\u5b83\u900f\u904e\u65b0\u589e\u4e0b\u5217\u767b\u9304\u9805\u76ee\u8a3b\u518a\u70ba\u7cfb\u7d71\u670d\u52d9\uff0c\u4ee5\u78ba\u4fdd\u5176\u53ef\u5728\u6bcf\u6b21\u7cfb\u7d71\u555f\u52d5\u6642\u81ea\u52d5\u57f7\u884c\uff1aHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nType = \"1\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nStart = \"4\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nErrorControl = \"0\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nDisplayName = \"Micorsoft Windows Service\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nDeleteFlag = \"1\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Micorsoft Windows Service\nImagePath = \"%Application Data%\\{random}\\{random}.sys\"\u5b83\u6703\u65b0\u589e\u4e0b\u5217\u767b\u9304\u9805\u76ee\uff0c\u4f7f\u5176\u5728\u6bcf\u6b21\u7cfb\u7d71\u555f\u52d5\u6642\u81ea\u52d5\u57f7\u884c\uff1aHKEY_CURRENT_USER\\Software\\Microsoft\\\nWindows\\CurrentVersion\\Run\n{random}  = \"%Application Data%\\{random}\\{random}.exe\"\u5176\u4ed6\u7cfb\u7d71\u4fee\u6539\u5b83\u6703\u65b0\u589e\u4e0b\u5217\u767b\u9304\u9805\u76ee\uff0c\u505a\u70ba\u5176\u5b89\u88dd\u5e38\u5f0f\u7684\u4e00\u90e8\u5206\uff1aHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\SharedAccess\\Parameters\\\nFirewallPolicy\\StandardProfile\\AuthorizedApplications\\\nList\n%Program Files%\\Internet Explorer\\IEXPLORE.EXE  = \"%Program Files%\\Internet Explorer\\IEXPLORE.EXE:*:Enabled:internet Explorer\"\u5b83\u6703\u4fee\u6539\u4e0b\u5217\u767b\u9304\u9805\u76ee\uff1aHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows NT\\CurrentVersion\\Winlogon\nUserinit = \"%System%\\userinit.exe,%Application Data%\\{random}\\{random}.exe\"(Note: The default value data of the said registry entry is %System%\\userinit.exe,.)HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows NT\\CurrentVersion\\Winlogon\nUserinit  = \"%System%\\userinit.exe,%Program Files%\\{random}\\{random}.exe\"(Note: The default value data of the said registry entry is %System%\\userinit.exe,.)\u5b83\u6703\u522a\u9664\u4e0b\u5217\u767b\u9304\u6a5f\u78bc\uff1aHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nControl\\SafeBoot\\MinimalHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nControl\\SafeBoot\\Network",
            "solution": ""
        }
    ]
}