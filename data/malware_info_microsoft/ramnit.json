{"name": "ramnit", "content": [{"summary": "Windows Defender Antivirusdetects and removes this threat. <br> Thismalwarefamily steals your sensitive information, such as your bank user names and passwords. It can also give a malicious hacker access and control of your PC, and stop your security software from running. <br> These threatscan be installed on your PCthrough an infected removable drive, such as a USB flash drive. <br>  <br> ", "tech": "Threat behavior  <br> Installation <br> The threat copies itself using a hard-coded name or, in some cases, with a random file name to a random folder, for example: <br> %ProgramFiles%\\Microsoft\\desktoplayer.exe <br> %ProgramFiles% <br> \\blvvcvww\\jonimvgn.exe <br> %ProgramFiles% <br> \\Microsoft\\watermark.exe <br> Some variants copy themselves to the%TEMP% folder with a random name, for example lvjekdwi.exe, hvhvufsa.exe.  <br> Thisfile might be detected as Worm:Win32/Ramnit.A or by another similar detection name. <br> It creates the following registry entry to ensure that it runs each time you start your PC: <br> In subkey: HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WinlogonSets value:  Userinit Withdata: <system folder>\\userinit.exe, <malware folder path and file name> , for example  %ProgramFiles%\\Microsoft\\watermark.exe  <br> Win32/Ramnit launches a new instance of the system process svchost.exe and injects code into it. If the malware is unable to inject its code into svchost, it searches for your default web browser and injects its code into the browser's process. <br> The malware hooks the followingAPIs for this purpose: <br> ZwCreateUserProcess <br> ZwWriteVirtualMemory <br> The infection and backdoor functionality occurs in the web browser process context; it might do this to avoid detection and make cleaning an infection more difficult. <br> Spreads through <br> File infection <br> Older variants of Win32/Ramnit spread by infecting certain files with virus code. However, we have seen new variants without this file-infection functionality. The reason for the removal of this functionality in new variants might be to hinder detection and removal of the variant. <br> Older versions of the malware infect: <br> Windows executable files with a file extension of .exe, .dll, and .scr. <br> The infected executables might be detected as Virus:Win32/Ramnit.A or by another similar detection name. <br> HTML document files with .html or .htm extensions. <br> The infected HTML files might be detected as Virus:VBS/Ramnit.A or by another similar detection name. The infected HTML files have an appended VBScript. When the infected HTML file is loaded by a web browser, the VBScript might drop a copy ofWin32/Ramnitas %TEMP%\\svchost.exeand then run the copy. <br> Microsoft OfficeOLE document fileswith .doc, .docx, or .xls file extensions. <br> The infected document might be detected as Virus:O97M/Ramnit. The infected document contains a macro which will attempt to run when the document is opened. The macro might drop a copy of Win32/Ramnitas %TEMP%\\wdexplore.exe and then run the copy. <br> Removable and network drives <br> Win32/Ramnit makes copies of the installer to removable drives with a random file name. The file might also be placed in a randomly-named directory in the \\RECYCLER\\folder in the root of the drive, as in the following example: <br> <drive:> <br> \\RECYCLER\\s-5-1-04-5443402830-2472267086-003818317-4634\\rdkidfba.exe <br> It also places an autorun.inf file in the root directory of the targeted drive. Such autorun.inf files tell the operating system to launch the malware file automatically when the network drive is accessed from another PC that supports the Autorun feature. <br> This is particularly common malware behavior, generally used to spread malware from PC to PC. <br> It should be noted that autorun.inf files on their own are not necessarily a sign of infection, as they are used by legitimate programs. <br> Payload <br> Connects to a remote server <br> Win32/Ramnitconnects and sends information to a remote server, which it connects through TCP port 443. <br> The malware generates the name of the command and control server using domain generation algorithm (DGA), for example: <br> caytmlnlrou.com <br> cxviaodxefolgkokdqy.com <br> empsqyowjuvvsvrwj.com <br> gokbwlivwvgqlretxd.com <br> htmthgurhtchwlhwklf.com <br> jiwucjyxjibyd.com <br> khddwukkbwhfdiufhaj.com <br> ouljuvkvn.com <br> qbsqnpyyooh.com <br> snoknwlgcwgaafbtqkt.com <br> swbadolov.com <br> tfgyaoingy.com <br> tiqfgpaxvmhsxtk.com <br> ubkfgwqslhqyy.com <br> ukiixagdbdkd.com <br> vwaeloyyutodtr.com <br> The malware downloads other components from the server. These componentschange often, andcan perform the following actions: <br> Steal FTP credentials (user names and passwords) <br> Enable backdoor access and control via  virtual network computing  (VNC) <br> Steal bank credentials (user names and passwords) <br> End or close certainantimalware programs <br> Win32/Ramnit can receive additional instructions from the server, including instructions to: <br> Download other malware <br> Shut down your PC <br> Take a screenshot <br> Update the malware to the latest version <br> Send collected information about cookies on your PC to the server <br> Delete cookies stored on your PC <br> Win32/Ramnit sends information about your PC to the server, including the following: <br> The name of your PC <br> The number of processes your PC has <br> The type of processor <br> The serial number of your PC's hard disk volume <br> The version andbuildof your operating system <br> The malware also receives a list of antimalware products from the remote server. It then closes or stops any processes related to those antimalware products. <br> Steals sensitive data <br> Win32/Ramnit might steal stored FTP passwords and user namesfrom a number of common FTP applications, including: <br> 32bit FTP <br> BulletproofFTP <br> ClassicFTP <br> Coffee cup ftp <br> Core Ftp <br> Cute FTP <br> Directory opus <br> Far Manager <br> FFFtp <br> FileZilla <br> FlashXp <br> Fling <br> Frigate 3 <br> FtpCommander <br> FtpControl <br> FtpExplorer <br> LeapFtp <br> NetDrive <br> SmartFtp <br> SoftFx FTP <br> TurboFtp <br> WebSitePublisher <br> Windows/Total commander <br> WinScp <br> WS FTP <br> Win32/Ramnit might also steal bank credentials by hooking the following APIs: <br> HttpOpenRequestA <br> HttpOpenRequestW <br> HttpSendRequestA <br> HttpSendRequestExA <br> HttpSendRequestExW <br> HttpSendRequestW <br> InternetCloseHandle <br> InternetOpenUrlA <br> InternetOpenUrlW <br> InternetQueryDataAvailable <br> InternetReadFile <br> InternetReadFileExA <br> InternetReadFileExW <br> InternetWriteFile <br> The malware collects stored browser cookies from the following web browsers: <br> Chrome <br> Firefox <br> Internet Explorer <br> Opera <br> Safari <br> The captured credentials are thensent to a remote server for collection by a hacker. <br> Disables security and antimalwaresoftware and services <br> The malware disables certain Windowsfunctions thatare designed to keep your PC safer and more secure. It disables these functionsby makinga number ofregistry modifications. <br> It disables the LUA (Least Privileged User Account), also known as the  administrator in Admin Approval Mode  user type, by making the following registry modifications: <br> In subkey: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\SystemSets value:  EnableLUA With data:  0  <br> It disables Windows Security Center: <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Security CenterSets value:  AntiVirusOverride With data:  1  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\wscsvcSets value:  Start With data:  4  <br> It disablesWindows Defender: <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\WinDefendSets value:  Start With data:  4  <br> It disablesthe Windows Update AutoUpdate Service: <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\wuauservSets value:  Start With data:  4  <br> It disablesthe Windows Firewall: <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileSets value:  EnableFirewall With data:  0  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\MpsSvcSets value:  Start With data:  4  <br> Itdisables the RapportMgmtService, if itexists on your PC.This service belongs to Rapport, which is a security program that you or your network administratormight have installed on your PC. <br> Itmight also disable or close certain antimalware products, including AVG Antivirus 2013. <br> The malware also tampers with your default Windows security settings by enabling the following functions: <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Security CenterSets value:  AntiVirusOverride With data:  1  <br> Sets value:  AntiVirusDisableNotify With data:  1  <br> Sets value:  FirewallDisableNotify With data:  1  <br> Sets value:  FirewallOverride With data:  1  <br> Sets value:  UpdatesDisableNotify With data:  1  <br> Sets value:  UacDisableNotify With data:  1  <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Security Center\\SvcSets value:  AntiVirusOverride With data:  1  <br> Sets value:  AntiVirusDisableNotify With data:  1  <br> Sets value:  FirewallDisableNotify With data:  1  <br> Sets value:  FirewallOverride With data:  1  <br> Sets value:  UpdatesDisableNotify With data:  1  <br> Sets value:  UacDisableNotify With data:  1  <br> Further reading <br> Ramnit - The renewed bot in town <br> Little Red Ramnit: My, what big eyes you have, Grandma! <br> Microsoft Security Intelligence Report Volume 11: January - June 2011 <br> Ramnit evolution  From worm to financial malware <br> Ramnit goes social <br> Analysis by Scott Molenkamp, Karthik Selvaraj, and Tim Liu <br> Prevention  <br> Take these steps to help prevent infection on your PC. <br>  <br> ", "symptoms": "The following can indicate that you have this threat on your PC: <br> Your antimalware or security product might not work correctly, or might not work at all. <br> You have these files:  %TEMP%\\wdexplore.exe  %TEMP%\\svchost.exe <br> You see these entries or keys in your registry: <br> In subkey: HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\WinlogonSets value:  Userinit Withdata: <system folder>\\userinit.exe, <malware folder path and file name> , for example  %ProgramFiles%\\Microsoft\\watermark.exe  <br> In subkey: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\SystemSets value:  EnableLUA With data:  0  <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Security CenterSets value:  AntiVirusOverride With data:  1  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\wscsvcSets value:  Start With data:  4  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\WinDefendSets value:  Start With data:  4  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\wuauservSets value:  Start With data:  4  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileSets value:  EnableFirewall With data:  0  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\MpsSvcSets value:  Start With data:  4  <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Security CenterSets value:  AntiVirusOverride With data:  1 <br> Sets value:  AntiVirusDisableNotify With data:  1  <br> Sets value:  FirewallDisableNotify With data:  1  <br> Sets value:  FirewallOverride With data:  1  <br> Sets value:  UpdatesDisableNotify With data:  1 <br> Sets value:  UacDisableNotify With data:  1 <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Security Center\\SvcSets value:  AntiVirusOverride With data:  1 <br> Sets value:  AntiVirusDisableNotify With data:  1 <br> Sets value:  FirewallDisableNotify With data:  1  <br> Sets value:  FirewallOverride With data:  1  <br> Sets value:  UpdatesDisableNotify With data:  1  <br> Sets value:  UacDisableNotify With data:  1  <br>  <br> ", "what2do": "Run antivirus or antimalware software <br> Use the following freeMicrosoft software todetect and remove this threat: <br> Windows Defender Antivirus <br> for Windows 10 and Windows 8.1, or Microsoft Security Essentials for Windows 7 and Windows Vista <br> Microsoft Safety Scanner <br> Microsoft Windows Malicious Software Removal Tool <br> You should also run a full scan. A full scan might find hidden malware. <br> Advanced troubleshooting <br> To restore your PC, you might need to download and run Windows Defender Offline. See ouradvanced troubleshooting pagefor more help. <br> Get more help <br> You can also visit our advanced troubleshooting pageor search the Microsoft virus and malware community for more help. <br> If youre using Windows XP, see our Windows XP end of support page. <br> NOTE: The Microsoft Windows Malicious Software Removal Tool automatically restores the default Windows security setting as it remediates this malware issue. However, if you encounter any issues, you can also manually enable the Windowsfunctions thatthe malware disabled to tamper with your system and lower your Windows security. <br> Enable the LUA (Least Privileged User Account), also known as the  administrator in Admin Approval Mode  user type, by modifying the following registry entries:  <br> In subkey: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\SystemSets value:  EnableLUA With data:  1  <br> Delete the following keys whichdo not exist by default:HKLM\\SOFTWARE\\Microsoft\\Security Center\\\\AntiVirusOverrideHKLM\\SOFTWARE\\Microsoft\\Security Center\\\\AntiVirusDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\\\FirewallDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\\\FirewallOverrideHKLM\\SOFTWARE\\Microsoft\\Security Center\\\\UpdatesDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\\\UacDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\Svc\\\\AntiVirusOverrideHKLM\\SOFTWARE\\Microsoft\\Security Center\\Svc\\\\AntiVirusDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\Svc\\\\FirewallDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\Svc\\\\FirewallOverrideHKLM\\SOFTWARE\\Microsoft\\Security Center\\Svc\\\\UpdatesDisableNotifyHKLM\\SOFTWARE\\Microsoft\\Security Center\\Svc\\\\UacDisableNotify <br> Enablethe Windows Firewall by modifying the following registry entries: <br> In subkey:HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileSets value: EnableFirewall With data:  1  <br> In the Run command field, type services.msc to go to the Services manager console. <br> Search for following services: <br> Security Center <br> Windows Defender Service <br> Windows Firewall <br> Windows Update <br> Right-click, then go to Properties. <br> Set the Startup type to Automatic. <br> Protect your sensitive information <br> This threat tries to steal your sensitive and confidential information. If you think your information has been stolen, see: <br> What to do if you are a victim of fraud <br> You should change your passwords after you've removed this threat: <br> Create strong passwords <br> Advanced troubleshooting <br> To restore your PC, you might need to download and run Windows Defender Offline. See our advanced troubleshooting pagefor more help. <br> Enable MAPS <br> Enable the Microsoft Active Protection Service(MAPS) on your system to protect your enterprise software security infrastructure in the cloud. <br> Check if MAPS is enabled in your Microsoft security product: <br> Select Settings and then select MAPS. <br> Select Advanced membership, then click Save changes. With the MAPS option enabled, your Microsoft anti-malware security product can take full advantage of Microsoft's cloud protection service. <br> Join the Microsoft Active Protection Service Community. <br> Get more help <br> You can also ask for help from other PC users at the Microsoft virus and malware community. <br> If youre using Windows XP, see our Windows XP end of support page. <br>  <br> "}, {"summary": "Windows Defender <br>  detects and removes this threat. <br> Thisvirus infects Windows executable files (.EXE) and HTML files (.HTML).It can also give a malicious hacker access to your PC. <br> Itspreads through infected removable drives, such as USB flash drives. <br> Find out ways that malware can get on your PC. <br>  <br> ", "tech": "Threat behavior  <br> Installation <br> When the virus runs,it drops a file as  <file name>Srv.exe  (for example,  mytestSvr.exe ), where <file name> is the file name of the infected executable. The dropped file is then run. <br> This file might be detected as Worm:Win32/Ramnit.A. <br> Spreads through <br> Infects files <br> Virus:Win32/Ramnit.A infects .HTML files with .HTML or .HTM extensions. The infected .HTML or .HTM files might be detected as Virus:VBS/Ramnit.A. <br> Payload <br> Allows backdoor access and control / Connects to remote server <br> Virus:Win32/Ramnit.A creates a backdoor by connecting to a remote server. Using this backdoor, a remote hacker can perform any number of actions, including downloading and running files on the infected PC. <br> See the description forWorm:Win32/Ramnit.A for more details on how the malware downloads and runs files. <br> Injects code <br> The virus creates a default web browser process (which you won't be able to see) and injects code into it. <br> It might do this as a way to avoid detection and make it more difficult to remove from an infected PC. <br> Analysis by Chun Feng <br> Prevention  <br> Take these steps to help prevent infection on your PC. <br>  <br> ", "symptoms": "The following can indicate that you have this threat on your PC: <br> You have this file:<file name>Srv.exe <br>  <br> ", "what2do": "Use the following freeMicrosoft software todetect and remove this threat: <br> Windows Defender Antivirus <br>  for Windows 10 and Windows 8.1, or Microsoft Security Essentials for Windows 7 and Windows Vista <br> Microsoft Safety Scanner <br> You should also run a full scan. A full scan might find other hidden malware. <br> Scan removable drives <br> Remember to scan any removable or portable drives. If you have Microsoft security software, see this topic onour software help page: <br> How do I scan a removable drive, such as a USB flash drive? <br> Get more help <br> You can also visit our advanced troubleshooting pageor search the Microsoft virus and malware community for more help. <br> If youre using Windows XP, see our Windows XP end of support page. <br>  <br> "}]}