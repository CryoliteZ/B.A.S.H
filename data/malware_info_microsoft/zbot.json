{"name": "zbot", "content": [{"summary": "Microsoft <br>  security software detects and removes this threat. <br> This family of trojans can steal your personal and financial information, and give a malicious hacker access and control of your PC. They can also lower your Internet browser security and turn off your firewall. <br> We have seen these threats download othermalware, includingthreats from the Win32/Crilock and Win32/Necurs families. Crilockransomware canencrypts your files and then demand money to unlock them.Necursmalware can disable your security software and redirect your web browser. <br> Win32/Zbot can be installed on your PC via spam emails and hacked websites, or packaged with other malware families. <br> Find out ways that malware can get on your PC. <br>  <br> ", "tech": "Threat behavior  <br> Win32/Zbot is a family of trojans that are created by kits known as  Zeus . These kits are bought and sold on the cyberworld black market. <br> They can monitor online banking activities by hooking API addresses and injecting code into webpages. <br> Distribution methods <br> Win32/Zbot is a widespread and pervasive malware family. It uses different methods to spread and infect your PC. <br> Downloaded by other malware <br> Win32/Zbot might be installed by other malware or exploit families. These families download Zbot as part of their criminal activity to steal information about your PC: <br> TrojanDownloader:Win32/Bredolab <br> TrojanDownloader:Win32/Upatre <br> Win32/Cutwail <br> Win32/Dofoil <br> Win32/Gamarue <br> Win32/Fareit <br> Win32/Kelihos <br> Win32/Kuluoz <br> Win32/Vobfus <br> Win32/Waledac <br> Win32/Zbot might also be downloaded as a payload for exploit kits like Blackhole (we detect this as Blacole), and for exploits including: <br> Exploit:Java/CVE-2011-3544 <br> Exploit:Java/CVE-2012-0507 <br> Exploit:Java/CVE-2012-1723 <br> Exploit:Java/CVE-2013-0422 <br> Exploit:JS/Aimesu <br> Exploit:Win32/Pdfjsc <br> Spam email <br> The trojan might arrive in a spam email. <br> The following are examples of a few spam messages that contain Zbot: <br> Subject: <Courier name> Failure Delivery Notification MessageAttachment: SN_122010.zip <br> Subject: <Social network site> Password Reset ConfirmationAttachment: <Social network site>_Password_e9081.zip <br> Subject: <Software company> Software Critical Upgrade Notification ID: RA4NFDKPJBDAttachment: <Software company>Systems-Software_Critica Update_Dec_2011-6PGCF713B.zip <br> Subject: Important Account Information from <Company name> TRACK-ID: 70341011278Attachment: <Company name>-Account-Status-Notification-Dec-2011.exe <br> Subject: Your credit balance is over its limits.Attachment: balancechecker.zip <br> Phishing pages and exploit kits <br> Exploit kits can generate versions of Win32/Zbot to spread to vulnerable PCs. <br> Spam emails contain the following information, including a link to a phishing page disguised as a social networking, courier, or online banking site. Instead, it redirects you to sites containing Win32/Zbot generated by exploit kits: <br> Subject: New login system <br> Subject: Password reset <br> The following is an example of a spam email that directs users to phishing pages hosting the trojan: <br> Subject: your <Company Name> money transfer has been authorizedImage: <br> Bundled with other malware <br> Some variants of Zbot are bundled with an exploit component detected as Exploit:Win32/CplLnk.B. <br> Remote Desktop Service <br> If your PC is running Remote Desktop Service (RDS), Zbot might try to run a process for every connected RDS session and create a copy of itself in the startup folder: <br> %RDSUserProfilePath%\\Start Menu\\Programs\\Startup\\<random letters>.exe <br> where %RDSUserProfilePath% is generated by enumerating each user in this registry key using a unique security identifier (SID): <br> In subkey: HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileListSets value: ProfileImagePath <br> For example, if the administrator account SID is: <br> S-1-5-21-1844237615-2111687655-839522115-500 <br> Then the profile path is: <br> HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1844237615-2111687655-839522115-500 <br> If ProfileImagePath is: <br> %SystemDrive% <br> \\Documents and Settings\\Administrator <br> Then the dropped file is: <br> C:\\Documents and Settings\\Administrator\\Programs\\Startup\\<random letters>.exe <br> This means that, as your PC is remotely connected to other PCs, there is a risk that other PCs will be infected as well. <br> Removable, fixed, shared and remote drives <br> Some variants of Zbot might arrive as an infected file. These infected files are detected as either Virus:Win32/Zbot.C or Virus:Win32/Zbot.C. <br> Installation <br> Some versions of Win32/Zbot drop copies of itself as any of the following files: <br> <system folder>\\ntos.exe <br> <system folder>\\sdra64.exe <br> <system folder>\\twex.exe <br> It also drops the following files, containing encrypted data used by the trojan, to the folder <system folder>\\wsnpoem\\: <br> audio.dll <br> video.dll <br> It also creates either of the following encrypted log files, where it stores the stolen data: <br> <system folder>\\twain_32\\user.ds <br> <system folder>\\lowsec\\user.ds <br> Win32/Zbot changes the registry to ensure that it runs each time you start your PC: <br> In subkey: HKLM\\Software\\Microsoft\\Windows NT\\Currentversion\\WinlogonSets value:  userinit With data:  <system folder>\\userinit.exe,<system folder>\\<malware file>  <br> where <malware file> is any of the file names mentioned above. <br> Other versions of Win32/Zbot drops copies of itself as a randomly named file: <br> %APPDATA% <br> \\<random letters>\\<random letters>.exe <br> %TEMP% <br> \\<random letters>\\<random letters>.exe <br> For example, C:\\Documents and Settings\\Administrator\\Application Data\\ecymy\\huojq.exe. <br> Some variants make the following changes to the registry to ensure that they run each time you start your PC: <br> In subkey: HKCU\\Software\\Microsoft\\Windows\\Currentversion\\RunSets value:  {GUID of Windows volume}  (for example,  {449829B8-9322-5694-4C31-974E87EDDDA5} )With data:  %APPDATA%\\<random letters>\\<random letters>.exe  (for example,  C:\\Documents and Settings\\Administrator\\Application data\\ecymy\\huojq.exe ) <br> In subkeys: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run and HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunSets value:  <random number> , for example,  2772969301 With data:  %APPDATA%\\<random letters>\\<random letters>.exe , for example,  %APPDATA%\\ecymy\\huojq.exe  <br> Some variants of Zbot also create a scheduled job that runs regularly. The job might be named Security Center Update - <random nine digit number>. <br> It also creates this registry entry as part of its installation process: <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\SubSystemsSets value:  Windows With data:  <system folder>\\csrss.exe objectdirectory=\\windows sharedsection=1024,1536,512 windows=on subsystemtype=windows serverdll=basesrv,1 serverdll=winsrv:userserverdllinitialization,3 serverdll=winsrv:conserverdllinitialization,2 profilecontrol=off maxrequestthreads=16  <br> Zbot tries to injecet code into the address space of all running processes, matching the privilege of the currently logged on user. If it fails, the trojan instead injects its code into all user-level processes (like explorer.exe, iexplore.exe and so on). This behavior hides the trojan from security applications. <br> It also hooks the following Windows system APIs to help it capture sensitive data, for example, online banking and shopping, email credentials and network information: <br> NSPR.DLL <br> PR_Close <br> PR_OpenTCPSocket <br> PR_Poll <br> PR_Read <br> PR_Write <br> NTDLL.DLL <br> LdrLoadDl <br> NtCreateThread  <br> NtCreateUserProcess  <br> RtlUserThreadStart  <br> ZwCreateThread  <br> KERNEL32.DLL <br> GetFileAttributesExW <br> WININET.DLL <br> HttpQueryInfoA <br> HttpQueryInfoW <br> HttpSendRequestA <br> HttpSendRequestExA <br> HttpSendRequestExW <br> HttpSendRequestW <br> InternetCloseHandle <br> InternetQueryDataAvailable <br> InternetReadFile <br> InternetReadFileExA <br> InternetReadFileExW <br> InternetSetOptionA <br> InternetSetStatusCallbackA <br> InternetSetStatusCallbackW <br> InternetWriteFile <br> WS2_32.DLL <br> closesocket <br> recv <br> send <br> WSAGetOverlappedResult <br> WSARecv <br> WSASend <br> GDI32.DLL <br> CallWindowProcA <br> CallWindowProcW <br> DefDlgProcA <br> DefDlgProcW <br> DefFrameProcA <br> DefFrameProcW <br> DefMDIChildProcA <br> DefMDIChildProcW <br> DefWindowProcA <br> DefWindowProcW <br> OpenInputDesktop <br> RegisterClassA <br> RegisterClassExA <br> RegisterClassExW <br> RegisterClassW <br> SwitchDesktop <br> USER32.DLL <br> BeginPaint <br> EndPaint <br> GetCapture <br> GetClipboardData <br> GetCursorPos <br> GetDC <br> GetDCEx <br> GetMessageA <br> GetMessagePos <br> GetMessageW <br> GetUpdateRect <br> GetUpdateRgn <br> GetWindowDC <br> PeekMessageA <br> PeekMessageW <br> ReleaseCapture <br> ReleaseDC <br> SetCapture <br> SetCursorPos <br> TranslateMessage <br> CRYPT32.DLL <br> PFXImportCertStore <br> SSLEAY32.DLL <br> SSL_read  <br> SSL_write <br> SECUR32.DLL <br> DecryptMessage  <br> DeleteSecurityContext <br> EncryptMessage <br> If the infected PC runs Remote Desktop Service (RDS), Zbot creates copy of itself to the default user startup folder as a randomly named file: <br> <DefaultUserPath>\\Programs\\Startup\\<random letters>.exe <br> Examples of the <DefaultUserPath> are: <br> %USERPROFILE%\\Default user\\ <br> %USERPROFILE%\\Default\\ <br> %USERPROFILE%\\<User name>\\ <br> %USERPROFILE%\\<User name>\\ <br> Payload <br> Downloads other malware, including ransomware <br> Win32/Zbot downloads variants of the Win32/Crilock family. This is a family of ransomware that encrypts the files on your PC and then demands money to unlock them. <br> You can help protect your PC from ransomware by reading more about Win32/Crilock and our help topics about ransomware. <br> Disables Windows Firewall <br> Zbot makes these changes to the registry to disable the Windows Firewall: <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileChanges value:  EnableFirewall With data:  0  <br> It also stops these processes: <br> Outpost Firewall - outpost.exe <br> Zone Alarm Firewall - zlclient.exe <br> Changes Firewall settings <br> Zbot makes the following changes to the registry to prevent Windows Firewall from blocking the threat's UDP port: <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfileChanges value:  DisableNotifications With data:  1  <br> In subkey: HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\GloballyOpenPorts\\ListChanges value:  <UDP port>:UDP With data:  <UDP port>:udp:*:enabled:udp <UDP port>  <br> Lowers Internet Explorer security <br> Win32/Zbot lowers Internet Explorer web browser security settings by making these changes to the registry: <br> Disables phishing filtering: <br> In subkey: HKCU\\Software\\Microsoft\\Internet Explorer\\PhishingFilterSets value:  Enabled With data:  0 Sets value:  EnabledV8 With data:  0  <br> Prevents the removal of expired Internet Explorer browser cookies: <br> In subkey: HKCU\\Software\\Microsoft\\Internet Explorer\\PrivacySets value:  CleanCookies With data:  0  <br> Lowers Internet Explorer Internet zone security settings: <br> In subkey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0Set value:  1609 With data:  0  <br> In subkey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\1Sets value:  1406 With data:  0  <br> In subkey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\2Sets value:  1609 With data:  0  <br> In subkey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3Sets value:  1406 With data:  0  <br> In subkey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\4Sets value:  1406 With data:  0  <br> Lowers Firefox security <br> Win32/Zbot might change the settings for the web browser Mozilla Firefox including: <br> Disable your ability to clear Internet cookies <br> Disable the display of warning messages when viewing mixed secured and unsecure webpages <br> Disable the display of warning messages when submitting data to unsecure pages <br> Lets a malicious hacker access your PC <br> Win32/Zbot lets a malicious hacker gain access and control your PC, to varying degrees. Its level of control depends on the information in the configuration data in each particular variant. <br> The trojan can do several actions, including: <br> Reboot/shut down your PC <br> Uninstall Zbot <br> Update Zbot and its configuration file <br> Search and remove files and directories <br> Log you off your PC <br> Run a program <br> Steal or delete Internet Explorer cookies <br> Steal or delete certificates <br> Block or unblock URLs <br> Change the Internet Explorer homepage <br> Steal your FTP credentials <br> Steal your email login credentials <br> Steal your Flash Player credentials <br> Downloads configuration data file <br> Some variants of Zbot download a configuration file from a remote server that determines how the trojan will behave. The trojan can generate up to 1020 pseudo-randomly named domains, and tries to connect with the generated list to download a configuration file. The generated domain names are based on the system date and time and have one of these suffixes: <br> biz <br> com <br> info <br> net <br> org <br> ru <br> Some examples include: <br> dhqwyelbpndaqwljampjsoea.info <br> hbixougjfqxkftswinlfbars.org <br> jvklraqgyofcqhikfbazlltauhi.biz  <br> ofvgupbpsgaumfvkbuobevceuv.ru <br> rvowslrmvnfkblkfyttpfemwx.com <br> tsljnihhusyxzddltpci.net <br> The configuration file contains data used by the malware like: <br> Locations from which to download updates for Zbot <br> Locations from which to download additional data files <br> The version of the malware <br> Online financial institutions to target <br> HTML and JavaScript code for doing its data stealing payload <br> Your PC checks a predefined list that contains 20 IP addresses and ports of other infected PCs. Upon successful contact, the configuration file containing the C&C server is fetched from the other infected PCs (the  peers ). The list of peers is updated whenever other peers contact the installed copy of Zbot. The information of up to 100 peers, IP addresses, and UDP port combinations can be stored. <br> If none of the initial 10 peers respond, the trojan can generate up to 1000 pseudo-randomly named domains, and tries to connect with the generated list to download a new peer list. The data read from the domain is RSA-signed and validated through the public key store in the trojan's body. <br> Steals sensitive information  <br> Win32/Zbot hooks APIs used by Internet Explorer and Mozilla Firefox; it does this to monitor your online activities. It also injects HTML code into target websites to steal login credentials, when you visit these websites. <br> The trojan steals the following sensitive information from your PC: <br> Digital certificates <br> Internet Explorer and Firefox cookies <br> Cached passwords <br> Logged keystrokes <br> Images of screen and window captures <br> Passwords and other details (like credit card numbers), as you enter them in to targeted websites <br> Bitcoin <br>  wallet credentials (through monitoring Bitcoin clientsbitcoin-qt.exe and bitcoind.exe) <br> It also monitors online activity by intercepting targeted websites listed in the configuration file to steal your personal information like user name, password and credit card details. <br> The following are some of the target websites found in the configuration file of Zbot: <br> amazon.com <br> blogger.com <br> facebook.com <br> feedback.ebay.com/ws/eBayISAPI.dll?ViewFeedback& <br> flickr.com <br> ktt.key.com/ktt/cmd/logonFromKeyCom <br> ktt.key.com/ktt/cmd/validatePinForm <br> livejournal.com <br> microsoft.com <br> myspace.com <br> us.hsbc.com <br> youtube.com <br> Steals FTP credentials <br> The trojan collects FTP credentials (IP, port, user name, and passwords) from the following FTP software: <br> CoreFTP <br> FAR/FAR2 <br> FileZilla <br> FlashFXP <br> FTP Commander <br> SmartFTP <br> Total Commander <br> winscp <br> ws_ftp <br> Steals Windows Mail and Windows Live mail credentials <br> If your PC is running on Windows XP or below, Win32/Zbot uses the COM libraries msoeacct.dll and wab32.dll to capture these Windows mail account details: <br> Account name <br> Email address <br> Server <br> User name <br> Password <br> The .dll files are searched in the directory defined in the registry key: <br> HKLM\\SOFTWARE\\Microsoft\\WAB\\DLLPath\\ <br> Otherwise, if running on Windows Vista, Windows 7, or Windows 8, the trojan captures the credentials by parsing the Windows mail folder, specified in this registry subkey: <br> HKCU\\SOFTWARE\\Microsoft\\Windows Mail\\Store Root\\ <br> Steals  Full Tilt Poker  credentials <br> Win32/Zbot might capture logon credentials for the online gaming program Full Tilt Poker. The trojan resets logon data by deleting the following registry value: <br> HKCU\\Software\\Full Tilt Poker\\UserInfo\\UserName <br> The malware then monitors for logon activity for the game, and captures any credentials you enter. <br> It also logs keystrokes and gets desktop and window snapshots of the infected PC. <br> Tampers the Trusteer security components <br> If the Trusteer .dll components rooksbas.dll and rapportgp.dll exist on your PC, the trojan will to patch the .dlls in memory to avoid being detected. <br> Performs click-fraud <br> Zbot has been observed to be involved in click-fraud operations. It connects to certain C&C servers to receive information from the click-fraud operator. Some of the servers it connects to are: <br> defie-guret.su <br> hefu-juder.com <br> jogurt-jetr.com <br> joye-luck.su <br> tundra-red.com <br> valoherusn.su <br> Once connected, Zbot receives information as to what affiliate company would benefit from click-fraud. <br> Analysis by Rodel Finones, Zarestel Ferrer, and Patrick Estavillo <br> Prevention  <br> Take these steps to help prevent infection on your PC. <br>  <br> ", "symptoms": "The following could indicate that you have this threat on your PC: <br> You have these files: <br> <system folder> <br> \\ntos.exe <br> <system folder>\\sdra64.exe <br> <system folder>\\twex.exe <br> <system folder>\\wsnpoem\\audio.dll <br> <system folder>\\wsnpoem\\video.dll <br> <system folder>\\twain_32\\user.ds <br> <system folder>\\lowsec\\local.ds <br> <system folder>\\lowsec\\user.ds <br> The following programs mightstop running for no obvious reason: <br> Outpost Firewall - outpost.exe <br> Zone Alarm Firewall - zlclient.exe <br>  <br> ", "what2do": "Use the following freeMicrosoft software todetect and remove this threat: <br> Windows Defender Antivirus <br>  for Windows 10 and Windows 8.1, or Microsoft Security Essentials for Windows 7 and Windows Vista <br> Microsoft Safety Scanner <br> Microsoft Windows Malicious Software Removal Tool <br> You should also run a full scan. A full scan might find other, hidden malware. <br> Protect your sensitive information <br> This threat tries to steal your sensitive and confidential information. If you think your information has been stolen, see: <br> What to do if you are a victim of fraud <br> You should change your passwords after you've removed this threat: <br> Create strong passwords <br> Prevent malware infections from spam emails <br> For enterprise users: <br> Follow the appropriate Exchange Online Protection instructions to suit your business needs. <br> Learn about how Office 365 can help you block spam using machine learning. See First look at Advanced Threat Protection: new tools to stop unknown malware & phishing attacks for details. <br> Be aware of the dangers in opening suspicious emails. Don't open email attachments or links from untrusted sources. <br> The Microsoft SmartScreen filter can also help detect spam. Its built-in and enabled by default in Microsoft email programs. <br> Submit spam and non-spam messages to Microsoft for analysis. <br> Get more help <br> You can also visit our advanced troubleshooting pageor search the Microsoft virus and malware community for more help. <br> If youre using Windows XP, see our Windows XP end of support page. <br>  <br> "}]}