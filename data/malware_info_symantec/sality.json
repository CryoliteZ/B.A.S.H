{
    "name": "sality",
    "content": [
        {
            "summary": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\nW32.Sality is an entry-point obscuring (EPO) polymorphic file infector. It will infect executable files on local, removable and remote shared drives. The virus also creates a peer-to-peer (P2P) botnet and receives URLs of additional files to download. It then attempts to disable security software.\n\nInfection\nW32.Sality will infect executable files on local, removable and remote shared drives. It replaces the original host code at the entry point of the executable to redirect execution to the polymorphic viral code, which has been encrypted and inserted in the last section of the host file.\n\nIn addition to infecting local and remotely shared executable files, W32.Sality will purposely search for specific registry subkeys to infect the executable files that run when Windows starts.\n\n\nFunctionality\nThe W32.Sality family of threats has been around for some time as the first versions surfaced in 2003 and may have originated in Russia. At that time, W32.Sality was a less complicated file infector, prepending its viral code to a host file and having back door capability and keylogging functionality.\n\nOver the years the core functionalities remained the same but it has become more sophisticated by including additional features that aid worm-like propagation, ensure its survival, and perform maliciously damaging activities. Among these activities is the decentralized peer-to-peer network (P2P) that W32.Sality-infected computers create and populate.\n\n\n\nAs an entry-point obscuring (EPO) polymorphic file infector, the virus gains control of the host body by overwriting the file with complex and encrypted code instructions. The goal of the complex code is to make analysis more difficult for researchers to see the real purpose and functionality implemented in the code.\n\nIt spreads by infecting executable files on local, removable and remote shared drives. Infected files will have their original, initial instructions overwritten by complex code instructions with the encrypted viral code body located in the last section of the file.\n\nThe threat participates in a P2P botnet and receives URLs of additional files to download. Downloading and executing other malware or security risks is one of the primary goals of this virus. A compromised host carries with it a list of HTTP URLs that point to resources to be downloaded, decrypted, and executed. These URLs can also point to more URLs. The encryption used is RC4 with static keys embedded in the compromised host.\n\nThe threat also attempts to disable security software and modify security configurations. It alters the safe mode functionality to ensure it remains on the compromised computer. To help hide its presence and ensure continuity of execution, it will inject itself into all running processes except processes that belong to the system, the local service or the network service.\n\n\n\nGEOGRAPHICAL DISTRIBUTION\nSymantec has observed the following geographic distribution of this threat.\n\n\n\n\n\n\n\nPREVALENCE\nSymantec has observed the following infection levels of this threat worldwide.\n\n\n\n\nSYMANTEC PROTECTION SUMMARY\nThe following content is provided by Symantec to protect against this threat family.\n\n\nAntivirus signatures\nW32.Sality\nW32.HLLP.Sality.O\nW32.HLLP.Sality.Q\nW32.Sality.R\nW32.Sality.S\nW32.Sality.U\nW32.Sality.V\nW32.Sality.X\nW32.Sality.Y\nW32.Sality.AB\nW32.Sality.AE\nW32.Sality.AM\n\n\nAntivirus (heuristic/generic)\nW32.HLLP.Sality!inf\nW32.Sality!dr\nW32.Sality.V!inf\nW32.Sality.Y!inf\nW32.Sality!dam\n\n\nBrowser protection\nSymantec Browser Protection is known to be effective at preventing some infection attempts made through the Web browser.\n\n\nIntrusion Prevention System\nHTTP W32.Sality Activity\nSMB Sality File Activity\nSMB Critical File Tamper Activity\nAntivirus Protection Dates\nInitial Rapid Release version April 6, 2003\nLatest Rapid Release version November 21, 2013 revision 055\nInitial Daily Certified version April 6, 2003\nLatest Daily Certified version November 22, 2013 revision 001\nInitial Weekly Certified release date April 9, 2003\n",
            "tech": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\n1. Prevention and avoidance\n1.1 User behavior and precautions\n1.2 Patch operating system and software\n1.3 Address blocking\n1.4 Network port blocking\n1.5 Network shares\n2. Infection method\n2.1 Network shares\n3. Functionality\n3.1 System modifications\n3.2 Process injection\n3.3 Lowers security settings\n3.4 Infection Functionality\n3.5 Downloader capabilities\n3.6 Network activity\n4. Additional information\n\n\n\n1. PREVENTION AND AVOIDANCE\nThe following actions can be taken to avoid or minimize the risk from this threat.\n\n\n1.1 User behavior and precautions\nUsers are advised not to open or execute files from unknown sources.\n\nIt is also advisable to disconnect removable drives when not required. If write access is not required, enable the read only mode if the option is available.\n\nUsers should disable AutoPlay to prevent automatic launching of executable files on removable drives. More information may be found by reading this article: How to prevent a virus from spreading using the 'AutoRun' feature.\n\nUsers should turn off file sharing if its use is not required. If file sharing is required, users should use ACLs and password protection to limit access. In addition to this, the use of a firewall or IDS may block or detect back door server communications with remote client applications.\n\n\n1.2 Patch operating system and software\nUsers are advised to ensure that their operating systems and any installed software are fully patched, and antivirus and firewall software are up to date and operational. It is also recommended that users turn on automatic updates if available so that their computers can receive the latest patches and updates when they are made available.\n\n\n1.3 Address blocking\nWhile the domains will vary with new variants, we have recently observed the following domains in use. Block access to the following addresses using a firewall, router or add entries to the local hosts files to redirect the following addresses to 127.0.0.1:\n89.119.67.154\nbalsfhkewo7i487fksd.info\nbcash-ddt.net\nbclr-cash.net\nbddr-cash.net\nbmakemegood24.com\nbmoney-frn.net\nbperfectchoice1.com\nbpowqbvcfds677.info\nbtrn-cash.net\nbuynvf96.info\nbxxxl-cash.net\nkjwre77638dfqwieuoi.info\nkjwre9fqwieluoi.info\nkukutrustnet777.info\nkukutrustnet888.info\nkukutrustnet987.info\noceaninfo.co.kr\npedmeo222nb.info\npzrk.ru\ntechnican.w.interia.pl\n\n\n1.4 Network port blocking\nThe virus generates a random listening port based on the computer name and current executable file name, but may also use a default port. Blocking the following default port at network perimeter will help to reduce the risk to your computer:\nUDP port 9674\n\n\n1.5 Network shares\nThis threat is also known to spread inside large network by using shares, the following steps can help protect your computer against this threat.\nUsers are advised to ensure that all network shares are only opened when they are necessary for use.\nUse a strong password to guard any shared folders or accounts. A strong password is a password that is of sufficient length of 8 or more characters. The password should also use a combination of numeric, capital, lowercase characters and symbols. Commonly used words from everyday language should not be used as they may easily be defeated by a dictionary attack.\nDisable the autorun feature to prevent dropped files from running automatically when a network drive is opened.\nFor more information about the autorun feature and how to disable it, please review this blog entry.\n\n\n\n2. INFECTION METHOD\nW32.Sality will infect executable files on local, removable and remote shared drives. W32.Sality replaces the original host code at the entry point of the executable to redirect execution to the polymorphic viral code, which has been inserted in the last section of the host file.\n\n\n\nIn addition to infecting local and remotely shared executable files, W32.Sality will purposely search for the following registry subkeys to infect the executables associated with that subkey, including those executables that run when Windows starts:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n2.1 Network shares\nW32.Sality may iterate all available network shares and infect executable files on the remote shares.\n\n\n\n3. FUNCTIONALITY\nW32.Sality has five main areas of functionality, aside from System modifications, that we\u2019ll cover more in-depth below.\nInjects itself into processes so it is able to load downloaded DLLs into target processes.\nCompromises security settings\nInfects files on local drives and removable media\nDownloads files and URLs\nCreates a peer-to-peer (P2P) botnet\nSystem modifications made by the virus create side effects on the compromised computer.\n\nNote: Side effects created by associated threats are not included in this report.\n\n\n3.1 SYSTEM MODIFICATIONS\nThe following side effects may be observed on computers compromised by members of threat family.\n\nFiles created\n%System%\\drivers\\[RANDOM FILE NAME]\n\nFiles or folders deleted\nNone\n\nFiles or folders modified\nNone\n\nRegistry subkeys created\n\nIt creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nRegistry entries deleted\nThis virus deletes entries in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nRegistry entries modified (final values given)\nIt also modifies the following registry entries:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\n\n3.2 Process injection\nW32.Sality will not inject into processes that belong to the system, the local service or the network service. However, it does inject complex code instructions into other processes, allowing the code to load external DLLs that are downloaded from remote servers into target processes. This virus uses a named mutex based on the injected process ID (PID) for each injection so that it avoid repeatedly injecting code into the same processes.\n\n\n3.3 Lowers security\nThe virus attempts to prevent the compromised computer from starting into Safe Mode by deleting all entries located in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\n\nThe virus starts the Windows IP Filter Driver service and drops an embedded driver to the following location:\n%System%\\drivers\\[RANDOM FILE NAME]\n\nIt then creates and starts a service to load the driver. The driver blocks access to a variety of security software vendor web sites.\n\nThe virus then disables security software services and ends security software processes. It also disables registry editing and the task manager.\n\n\n3.4 Infection Functionality\nThis virus checks that a file is not protected by the Windows file protection mechanism (SFC) before trying to infect it. It then infects unprotected executable files on local, removable and remote shared drives. At the entry point of the executable, it replaces the original host code to redirect execution to the polymorphic viral code located in the last section of the host file.\n\nIt also infects executables connected to the registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n3.5 Downloader capabilities\nThe virus downloads and executes a variety of files including pay per install executables such as misleading applications. The flexibility of the downloader functionality lies in the continuous exchange of URL lists.\n\nW32.Sality also contains an initial list of URLs to download and execute and may receive new URLs from other infected peers.\n\nIt will either directly download, decrypt, and execute the specified binary or download a list of URLs, then download, decrypt, or execute each URL in the list.\n\n\n3.6 Network Activity\nW32.Sality participates in a peer-to-peer botnet using UDP. A variable listening port is generated (minimum 2199) based on the computer name and current executable file name and in some cases defaults to 9674.\n\nIt also contains a preconfigured list of up to 1000 peers (IP address and UDP port pairs). The goal of the P2P network is to exchange lists of URLs to feed to the downloader functionality. The P2P protocol offers only a few commands, the most important being:\nAsk a peer for its list of URLs\nGive a peer its own URL package\nAsk a peer to send the IP address and port of another peer in the botnet, in order to keep the list of peers up-to-date\nAll the peer-to-peer traffic is encrypted by means of RC4 encryption using static hard-coded keys.\n\nDownloading\nThe virus downloads files based on predetermined URLs contained in exchanged lists. These files can include additional malware threats and pay per install applications. It is possible that downloaded files may be updated versions of the virus.\n\nUploading\nW32.Sality will upload its own URL package to a peer.\n\n\nOther network activity\nNone\n\n\n4. ADDITIONAL INFORMATION\nFor more information relating to this threat family, please see the following resources:\n\nBlog Entries on W32.Sality\nSality: Story of a Peer-to-Peer Viral Network (Whitepaper - July 2011)\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n"
        },
        {
            "summary": "Discovered:\nApril 20, 2008\nUpdated:\nAugust 10, 2008 11:06:05 AM\nAlso Known As:\nW32/Sality.AA [F-Secure], Win32/Sality.AA [Computer Associates], Win32/Sality.Z [Computer Associates], Sality.AG [Panda Software], W32/Sality.ae [McAfee], TROJ_AGENT.XOO [Trend]\nType:\nVirus\nInfection Length:\n57,344 bytes\nSystems Affected:\nWindows\nW32.Sality.AE is a virus that spreads by infecting executable files and attempts to download potentially malicious files from the Internet.\n\nAutorun and W32.Sality\nSymantec strongly recommends that customers take specific steps to control the execution of applications referenced in autorun.inf files that may be located on removable and network drives. Threats such as this one frequently attempt to spread to other computers using these avenues. Configuration changes made to a computer can limit the possibility of new threats compromising it. For more information, see the following document:\n\nHow to prevent a virus from spreading using the \"AutoRun\" feature\n\nVirus definitions dated April 20, 2008 or earlier detect this threat as W32.Bacalid!inf.\n\nFor more information, please see the following resources:\nW32.Sality\n\n\nSymantec Endpoint Protection \u2013 Application and Device Control\nSymantec Security Response has developed an Application and Device Control (ADC) Policy for Symantec Endpoint Protection to protect against the activities associated with this threat. ADC policies are useful in reducing the risk of a threat infecting a computer, the unintentional removal of data, and to restrict the programs that are run on a computer.\n\nThis particular ADC policy can be used to help combat an outbreak of this threat by slowing down or eliminating its ability to spread from one computer to another. If you are experiencing an outbreak of this threat in your network, please download the policy.\n\nTo use the policy, import the .dat file into your Symantec Endpoint Protection Manager. When distributing it to client computers, we recommend using it in Test (log only) mode initially in order to determine the possible impacts of the policy on normal network/computer usage. After observing the policy for a period of time, and determining the possible consequences of enabling it in your environment, deploy the policy in Production mode to enable active protection.\n\nFor more information on ADC and how to manage and deploy them throughout your organization, please refer to the Symantec Endpoint Protection Administration Manual (PDF).\n\nNote: The ADC policies developed by Security Response are recommended for use in outbreak situations. While useful in such situations, due to their restrictive nature they may cause disruptions to normal business activities.\nAntivirus Protection Dates\nInitial Rapid Release version April 21, 2008 revision 001\nLatest Rapid Release version November 21, 2017 revision 052\nInitial Daily Certified version April 21, 2008 revision 003\nLatest Daily Certified version November 22, 2017 revision 003\nInitial Weekly Certified release date April 23, 2008\n",
            "tech": "Discovered:\nApril 20, 2008\nUpdated:\nAugust 10, 2008 11:06:05 AM\nAlso Known As:\nW32/Sality.AA [F-Secure], Win32/Sality.AA [Computer Associates], Win32/Sality.Z [Computer Associates], Sality.AG [Panda Software], W32/Sality.ae [McAfee], TROJ_AGENT.XOO [Trend]\nType:\nVirus\nInfection Length:\n57,344 bytes\nSystems Affected:\nWindows\nWhen the virus is executed, it copies itself as the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nThe virus creates the following mutex so only one instance of the virus is running:\nOp1mutx9\n\nIt then creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nIt then creates the following registry entry so that it bypasses the Windows Firewall:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\n\nIt modifies the following registry entries:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\nThe virus also deletes entries under the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nIt then registers itself as a new service with the following characteristics:\nService Name: WMI_MFC_TPSHOKER_80\nDisplay Name: WMI_MFC_TPSHOKER_80\nStartup Type: Automatic\n\nIt then deletes the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nIt stops the following services:\nALG\naswUpdSv\navast! Antivirus\navast! Mail Scanner\navast! Web Scanner\nAVP\nBackWeb Plug-in - 4476822\nbdss\nBGLiveSvc\nBlackICE\nCAISafe\nccEvtMgr\nccProxy\nccSetMgr\nF-Prot Antivirus Update Monitor\nfsbwsys\nFSDFWD\nF-Secure Gatekeeper Handler Starter\nfshttps\nFSMA\nInoRPC\nInoRT\nInoTask\nISSVC\nKPF4\nLavasoftFirewall\nLIVESRV\nMcAfeeFramework\nMcShield\nMcTaskManager\nnavapsvc\nNOD32krn\nNPFMntor\nNSCService\nOutpost Firewall main module\nOutpostFirewall\nPAVFIRES\nPAVFNSVR\nPavProt\nPavPrSrv\nPAVSRV\nPcCtlCom\nPersonalFirewal\nPREVSRV\nProtoPort Firewall service\nPSIMSVC\nRapApp\nSmcService\nSNDSrvc\nSPBBCSvc\nSymantec Core LC\nTmntsrv\nTmPfw\ntmproxy\nUmxAgent\nUmxCfg\nUmxLU\nUmxPol\nvsmon\nVSSERV\nWebrootDesktopFirewallDataService\nWebrootFirewall\nXCOMM\n\nIt infects all executable files listed under the following registry subkey:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\n\nIt infects all .exe executable files listed under the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nIt also infects all .exe and .scr files on the C drive and on any writable network resource, except the files on any folder with the following strings:\nSYSTEM\nAHEAD\n\nThe infected file size will increase 57,344 bytes.\n\nIt deletes any file whose name contains any of the following strings:\n.VDB\n.AVC\n.KEY\ndrw\n_AVPM\nA2GUARD\nAAVSHIELD\nAVAST\nADVCHK\nAHNSD\nAIRDEFENSE\nALERTSVC\nALMON\nALOGSERV\nALSVC\nAMON\nANTI-TROJAN\nAVZ\nANTIVIR\nANTS\nAPVXDWIN\nARMOR2NET\nASHAVAST\nASHDISP\nASHENHCD\nASHMAISV\nASHPOPWZ\nASHSERV\nASHSIMPL\nASHSKPCK\nASHWEBSV\nASWUPDSV\nATCON\nATUPDATER\nATWATCH\nAUPDATE\nAUTODOWN\nAUTOTRACE\nAUTOUPDATE\nAVCIMAN\nAVCONSOL\nAVENGINE\nAVGAMSVR\nAVGCC\nAVGCC32\nAVGCTRL\nAVGEMC\nAVGFWSRV\nAVGNT\nAVGNTDD\nAVGNTMGR\nAVGSERV\nAVGUARD\nAVGUPSVC\nAVINITNT\nAVKSERV\nAVKSERVICE\nAVKWCTL\nAVP\nAVP32\nAVPCC\nAVPM\nAVPUPD\nAVSCHED32\nAVSYNMGR\nAVWUPD32\nAVWUPSRV\nAVXMONITOR9X\nAVXMONITORNT\nAVXQUAR\nBACKWEB-4476822\nBDMCON\nBDNEWS\nBDOESRV\nBDSS\nBDSUBMIT\nBDSWITCH\nBLACKD\nBLACKICE\nCAFIX\nCCAPP\nCCEVTMGR\nCCPROXY\nCCSETMGR\nCFIAUDIT\nCLAMTRAY\nCLAMWIN\nCLAW95\nCLAW95CF\nCLEANER\nCLEANER3\nCLISVC\nCMGRDIAN\nCUREIT\nDEFWATCH\nDOORS\nDRVIRUS\nDRWADINS\nDRWEB32W\nDRWEBSCD\nDRWEBUPW\nESCANH95\nESCANHNT\nEWIDOCTRL\nEZANTIVIRUSREGISTRATIONCHECK\nF-AGNT95\nFAMEH32\nFAST\nFCH32\nFILEMON\nFIRESVC\nFIRETRAY\nFIREWALL\nFPAVUPDM\nF-PROT95\nFRESHCLAM\nFRW\nFSAV32\nFSAVGUI\nFSBWSYS\nF-SCHED\nFSDFWD\nFSGK32\nFSGK32ST\nFSGUIEXE\nFSM32\nFSMA32\nFSMB32\nFSPEX.\nFSSM32\nF-STOPW\nGCASDTSERV\nGCASSERV\nGIANTANTISPYWAREMAIN\nGIANTANTISPYWAREUPDATER\nGUARDGUI\nGUARDNT\nHREGMON\nHRRES\nHSOCKPE\nHUPDATE\nIAMAPP\nIAMSERV\nICLOAD95\nICLOADNT\nICMON\nICSSUPPNT\nICSUPP95\nICSUPPNT\nIFACE\nINETUPD\nINOCIT\nINORPC\nINORT\nINOTASK\nINOUPTNG\nIOMON98\nISAFE\nISATRAY\nISRV95\nISSVC\nKAV\nKAVMM\nKAVPF\nKAVPFW\nKAVSTART\nKAVSVC\nKAVSVCUI\nKMAILMON\nKPFWSVC\nKWATCH\nLOCKDOWN2000\nLOGWATNT\nLUALL\nLUCOMSERVER\nLUUPDATE\nMCAGENT\nMCMNHDLR\nMCREGWIZ\nMCUPDATE\nMCVSSHLD\nMINILOG\nMYAGTSVC\nMYAGTTRY\nNAVAPSVC\nNAVAPW32\nNAVLU32\nNAVW32\nNOD32\nNEOWATCHLOG\nNEOWATCHTRAY\nNISSERV\nNISUM\nNMAIN\nNOD32\nNORMIST\nNOTSTART\nNPAVTRAY\nNPFMNTOR\nNPFMSG\nNPROTECT\nNSCHED32\nNSMDTR\nNSSSERV\nNSSTRAY\nNTRTSCAN\nNTXCONFIG\nNUPGRADE\nNVC95\nNVCOD\nNVCTE\nNVCUT\nNWSERVICE\nOFCPFWSVC\nOUTPOST\nPAV\nPAVFIRES\nPAVFNSVR\nPAVKRE\nPAVPROT\nPAVPROXY\nPAVPRSRV\nPAVSRV51\nPAVSS\nPCCGUIDE\nPCCIOMON\nPCCNTMON\nPCCPFW\nPCCTLCOM\nPCTAV\nPERSFW\nPERTSK\nPERVAC\nPNMSRV\nPOP3TRAP\nPOPROXY\nPREVSRV\nPSIMSVC\nQHM32\nQHONLINE\nQHONSVC\nQHPF\nQHWSCSVC\nRAVMON\nRAVTIMER\nREALMON\nREALMON95\nRFWMAIN\nRTVSCAN\nRTVSCN95\nRULAUNCH\nSAVADMINSERVICE\nSAVMAIN\nSAVPROGRESS\nSAVSCAN\nSCAN32\nSCANNINGPROCESS\nCUREIT\nSDHELP\nSHSTAT\nSITECLI\nSPBBCSVC\nSPHINX\nSPIDERML\nSPIDERNT\nSPIDERUI\nSPYBOTSD\nSPYXX\nSS3EDIT\nSTOPSIGNAV\nSWAGENT\nSWDOCTOR\nSWNETSUP\nSYMLCSVC\nSYMPROXYSVC\nSYMSPORT\nSYMWSC\nSYNMGR\nTAUMON\nTBMON\nTC\nTCA\nTCM\nTDS-3\nTEATIMER\nTFAK\nTHAV\nTHSM\nTMAS\nTMLISTEN\nTMNTSRV\nTMPFW\nTMPROXY\nTNBUTIL\nTRJSCAN\nUP2DATE\nVBA32ECM\nVBA32IFS\nVBA32LDR\nVBA32PP3\nVBSNTW\nVCHK\nVCRMON\nVETTRAY\nVIRUSKEEPER\nVPTRAY\nVRFWSVC\nVRMONNT\nVRMONSVC\nVRRW32\nVSECOMR\nVSHWIN32\nVSMON\nVSSERV\nVSSTAT\nWATCHDOG\nWEBPROXY\nWEBSCANX\nWEBTRAP\nWGFE95\nWINAW32\nWINROUTE\nWINSS\nWINSSNOTIFY\nWRADMIN\nWRCTRL\nXCOMMSVR\nZATUTOR\nZAUINST\nZLCLIENT\nZONEALARM\n\nIt connects to the following URLs to get instructions. The instructions contain additional URLs to possibly download other malicious files:\n[http://]pedmeo222nb.info\n[http://]pzrk.ru\n[http://]technican.w.interia.pl\n[http://]www.kjwre9fqwieluoi.info\n[http://]bpowqbvcfds677.info\n[http://]bmakemegood24.com\n[http://]bperfectchoice1.com\n[http://]bcash-ddt.net\n[http://]bddr-cash.net\n[http://]btrn-cash.net\n[http://]bmoney-frn.net\n[http://]bclr-cash.net\n[http://]bxxxl-cash.net\n[http://]balsfhkewo7i487fksd.info\n[http://]buynvf96.info\n[http://]89.119.67.154/tes[REMOVED]\n[http://]oceaninfo.co.kr/picas[REMOVED]\n[http://]kukutrustnet777.info/home[REMOVED]\n[http://]kukutrustnet888.info/home[REMOVED]\n[http://]kukutrustnet987.info/home[REMOVED]\n[http://]kukutrustnet777.info\n[http://]www.kjwre9fqwieluoi.info\n[http://]kjwre77638dfqwieuoi.info\n\n\nIt prevents access to various security-related domains containing any of the following strings:\nCureit\nDrweb\nOnlinescan\nSpywareinfo\nEwido\nVirusscan\nWindowsecurity\nSpywareguide\nBitdefender\nPanda software\nAgnmitum\nVirustotal\nSophos\nTrend Micro\nEtrust.com\nSymantec\nMcAfee\nF-Secure\nEset.com\nKaspersky\n\nIt adds the following entry to %Windir%\\system.ini:\n[MCIDRV_VER]\n\nIt then copies itself to attached removable drives using the following filenames:\n%DriveLetter%:\\[RANDOM NAME].exe\n%DriveLetter%:\\[RANDOM NAME].cmd\n%DriveLetter%:\\[RANDOM NAME].pif\n\nThe following file is created on attached removable drives so that the threat runs whenever the drive is connected to a computer:\n%DriveLetter%:\\autorun.inf\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nApril 20, 2008\nUpdated:\nAugust 10, 2008 11:06:05 AM\nAlso Known As:\nW32/Sality.AA [F-Secure], Win32/Sality.AA [Computer Associates], Win32/Sality.Z [Computer Associates], Sality.AG [Panda Software], W32/Sality.ae [McAfee], TROJ_AGENT.XOO [Trend]\nType:\nVirus\nInfection Length:\n57,344 bytes\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n"
        },
        {
            "summary": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\n1. Prevention and avoidance\n1.1 User behavior and precautions\n1.2 Patch operating system and software\n1.3 Address blocking\n1.4 Network port blocking\n1.5 Network shares\n2. Infection method\n2.1 Network shares\n3. Functionality\n3.1 System modifications\n3.2 Process injection\n3.3 Lowers security settings\n3.4 Infection Functionality\n3.5 Downloader capabilities\n3.6 Network activity\n4. Additional information\n\n\n\n1. PREVENTION AND AVOIDANCE\nThe following actions can be taken to avoid or minimize the risk from this threat.\n\n\n1.1 User behavior and precautions\nUsers are advised not to open or execute files from unknown sources.\n\nIt is also advisable to disconnect removable drives when not required. If write access is not required, enable the read only mode if the option is available.\n\nUsers should disable AutoPlay to prevent automatic launching of executable files on removable drives. More information may be found by reading this article: How to prevent a virus from spreading using the 'AutoRun' feature.\n\nUsers should turn off file sharing if its use is not required. If file sharing is required, users should use ACLs and password protection to limit access. In addition to this, the use of a firewall or IDS may block or detect back door server communications with remote client applications.\n\n\n1.2 Patch operating system and software\nUsers are advised to ensure that their operating systems and any installed software are fully patched, and antivirus and firewall software are up to date and operational. It is also recommended that users turn on automatic updates if available so that their computers can receive the latest patches and updates when they are made available.\n\n\n1.3 Address blocking\nWhile the domains will vary with new variants, we have recently observed the following domains in use. Block access to the following addresses using a firewall, router or add entries to the local hosts files to redirect the following addresses to 127.0.0.1:\n89.119.67.154\nbalsfhkewo7i487fksd.info\nbcash-ddt.net\nbclr-cash.net\nbddr-cash.net\nbmakemegood24.com\nbmoney-frn.net\nbperfectchoice1.com\nbpowqbvcfds677.info\nbtrn-cash.net\nbuynvf96.info\nbxxxl-cash.net\nkjwre77638dfqwieuoi.info\nkjwre9fqwieluoi.info\nkukutrustnet777.info\nkukutrustnet888.info\nkukutrustnet987.info\noceaninfo.co.kr\npedmeo222nb.info\npzrk.ru\ntechnican.w.interia.pl\n\n\n1.4 Network port blocking\nThe virus generates a random listening port based on the computer name and current executable file name, but may also use a default port. Blocking the following default port at network perimeter will help to reduce the risk to your computer:\nUDP port 9674\n\n\n1.5 Network shares\nThis threat is also known to spread inside large network by using shares, the following steps can help protect your computer against this threat.\nUsers are advised to ensure that all network shares are only opened when they are necessary for use.\nUse a strong password to guard any shared folders or accounts. A strong password is a password that is of sufficient length of 8 or more characters. The password should also use a combination of numeric, capital, lowercase characters and symbols. Commonly used words from everyday language should not be used as they may easily be defeated by a dictionary attack.\nDisable the autorun feature to prevent dropped files from running automatically when a network drive is opened.\nFor more information about the autorun feature and how to disable it, please review this blog entry.\n\n\n\n2. INFECTION METHOD\nW32.Sality will infect executable files on local, removable and remote shared drives. W32.Sality replaces the original host code at the entry point of the executable to redirect execution to the polymorphic viral code, which has been inserted in the last section of the host file.\n\n\n\nIn addition to infecting local and remotely shared executable files, W32.Sality will purposely search for the following registry subkeys to infect the executables associated with that subkey, including those executables that run when Windows starts:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n2.1 Network shares\nW32.Sality may iterate all available network shares and infect executable files on the remote shares.\n\n\n\n3. FUNCTIONALITY\nW32.Sality has five main areas of functionality, aside from System modifications, that we\u2019ll cover more in-depth below.\nInjects itself into processes so it is able to load downloaded DLLs into target processes.\nCompromises security settings\nInfects files on local drives and removable media\nDownloads files and URLs\nCreates a peer-to-peer (P2P) botnet\nSystem modifications made by the virus create side effects on the compromised computer.\n\nNote: Side effects created by associated threats are not included in this report.\n\n\n3.1 SYSTEM MODIFICATIONS\nThe following side effects may be observed on computers compromised by members of threat family.\n\nFiles created\n%System%\\drivers\\[RANDOM FILE NAME]\n\nFiles or folders deleted\nNone\n\nFiles or folders modified\nNone\n\nRegistry subkeys created\n\nIt creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nRegistry entries deleted\nThis virus deletes entries in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nRegistry entries modified (final values given)\nIt also modifies the following registry entries:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\n\n3.2 Process injection\nW32.Sality will not inject into processes that belong to the system, the local service or the network service. However, it does inject complex code instructions into other processes, allowing the code to load external DLLs that are downloaded from remote servers into target processes. This virus uses a named mutex based on the injected process ID (PID) for each injection so that it avoid repeatedly injecting code into the same processes.\n\n\n3.3 Lowers security\nThe virus attempts to prevent the compromised computer from starting into Safe Mode by deleting all entries located in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\n\nThe virus starts the Windows IP Filter Driver service and drops an embedded driver to the following location:\n%System%\\drivers\\[RANDOM FILE NAME]\n\nIt then creates and starts a service to load the driver. The driver blocks access to a variety of security software vendor web sites.\n\nThe virus then disables security software services and ends security software processes. It also disables registry editing and the task manager.\n\n\n3.4 Infection Functionality\nThis virus checks that a file is not protected by the Windows file protection mechanism (SFC) before trying to infect it. It then infects unprotected executable files on local, removable and remote shared drives. At the entry point of the executable, it replaces the original host code to redirect execution to the polymorphic viral code located in the last section of the host file.\n\nIt also infects executables connected to the registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n3.5 Downloader capabilities\nThe virus downloads and executes a variety of files including pay per install executables such as misleading applications. The flexibility of the downloader functionality lies in the continuous exchange of URL lists.\n\nW32.Sality also contains an initial list of URLs to download and execute and may receive new URLs from other infected peers.\n\nIt will either directly download, decrypt, and execute the specified binary or download a list of URLs, then download, decrypt, or execute each URL in the list.\n\n\n3.6 Network Activity\nW32.Sality participates in a peer-to-peer botnet using UDP. A variable listening port is generated (minimum 2199) based on the computer name and current executable file name and in some cases defaults to 9674.\n\nIt also contains a preconfigured list of up to 1000 peers (IP address and UDP port pairs). The goal of the P2P network is to exchange lists of URLs to feed to the downloader functionality. The P2P protocol offers only a few commands, the most important being:\nAsk a peer for its list of URLs\nGive a peer its own URL package\nAsk a peer to send the IP address and port of another peer in the botnet, in order to keep the list of peers up-to-date\nAll the peer-to-peer traffic is encrypted by means of RC4 encryption using static hard-coded keys.\n\nDownloading\nThe virus downloads files based on predetermined URLs contained in exchanged lists. These files can include additional malware threats and pay per install applications. It is possible that downloaded files may be updated versions of the virus.\n\nUploading\nW32.Sality will upload its own URL package to a peer.\n\n\nOther network activity\nNone\n\n\n4. ADDITIONAL INFORMATION\nFor more information relating to this threat family, please see the following resources:\n\nBlog Entries on W32.Sality\nSality: Story of a Peer-to-Peer Viral Network (Whitepaper - July 2011)\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "tech": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\n1. Prevention and avoidance\n1.1 User behavior and precautions\n1.2 Patch operating system and software\n1.3 Address blocking\n1.4 Network port blocking\n1.5 Network shares\n2. Infection method\n2.1 Network shares\n3. Functionality\n3.1 System modifications\n3.2 Process injection\n3.3 Lowers security settings\n3.4 Infection Functionality\n3.5 Downloader capabilities\n3.6 Network activity\n4. Additional information\n\n\n\n1. PREVENTION AND AVOIDANCE\nThe following actions can be taken to avoid or minimize the risk from this threat.\n\n\n1.1 User behavior and precautions\nUsers are advised not to open or execute files from unknown sources.\n\nIt is also advisable to disconnect removable drives when not required. If write access is not required, enable the read only mode if the option is available.\n\nUsers should disable AutoPlay to prevent automatic launching of executable files on removable drives. More information may be found by reading this article: How to prevent a virus from spreading using the 'AutoRun' feature.\n\nUsers should turn off file sharing if its use is not required. If file sharing is required, users should use ACLs and password protection to limit access. In addition to this, the use of a firewall or IDS may block or detect back door server communications with remote client applications.\n\n\n1.2 Patch operating system and software\nUsers are advised to ensure that their operating systems and any installed software are fully patched, and antivirus and firewall software are up to date and operational. It is also recommended that users turn on automatic updates if available so that their computers can receive the latest patches and updates when they are made available.\n\n\n1.3 Address blocking\nWhile the domains will vary with new variants, we have recently observed the following domains in use. Block access to the following addresses using a firewall, router or add entries to the local hosts files to redirect the following addresses to 127.0.0.1:\n89.119.67.154\nbalsfhkewo7i487fksd.info\nbcash-ddt.net\nbclr-cash.net\nbddr-cash.net\nbmakemegood24.com\nbmoney-frn.net\nbperfectchoice1.com\nbpowqbvcfds677.info\nbtrn-cash.net\nbuynvf96.info\nbxxxl-cash.net\nkjwre77638dfqwieuoi.info\nkjwre9fqwieluoi.info\nkukutrustnet777.info\nkukutrustnet888.info\nkukutrustnet987.info\noceaninfo.co.kr\npedmeo222nb.info\npzrk.ru\ntechnican.w.interia.pl\n\n\n1.4 Network port blocking\nThe virus generates a random listening port based on the computer name and current executable file name, but may also use a default port. Blocking the following default port at network perimeter will help to reduce the risk to your computer:\nUDP port 9674\n\n\n1.5 Network shares\nThis threat is also known to spread inside large network by using shares, the following steps can help protect your computer against this threat.\nUsers are advised to ensure that all network shares are only opened when they are necessary for use.\nUse a strong password to guard any shared folders or accounts. A strong password is a password that is of sufficient length of 8 or more characters. The password should also use a combination of numeric, capital, lowercase characters and symbols. Commonly used words from everyday language should not be used as they may easily be defeated by a dictionary attack.\nDisable the autorun feature to prevent dropped files from running automatically when a network drive is opened.\nFor more information about the autorun feature and how to disable it, please review this blog entry.\n\n\n\n2. INFECTION METHOD\nW32.Sality will infect executable files on local, removable and remote shared drives. W32.Sality replaces the original host code at the entry point of the executable to redirect execution to the polymorphic viral code, which has been inserted in the last section of the host file.\n\n\n\nIn addition to infecting local and remotely shared executable files, W32.Sality will purposely search for the following registry subkeys to infect the executables associated with that subkey, including those executables that run when Windows starts:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n2.1 Network shares\nW32.Sality may iterate all available network shares and infect executable files on the remote shares.\n\n\n\n3. FUNCTIONALITY\nW32.Sality has five main areas of functionality, aside from System modifications, that we\u2019ll cover more in-depth below.\nInjects itself into processes so it is able to load downloaded DLLs into target processes.\nCompromises security settings\nInfects files on local drives and removable media\nDownloads files and URLs\nCreates a peer-to-peer (P2P) botnet\nSystem modifications made by the virus create side effects on the compromised computer.\n\nNote: Side effects created by associated threats are not included in this report.\n\n\n3.1 SYSTEM MODIFICATIONS\nThe following side effects may be observed on computers compromised by members of threat family.\n\nFiles created\n%System%\\drivers\\[RANDOM FILE NAME]\n\nFiles or folders deleted\nNone\n\nFiles or folders modified\nNone\n\nRegistry subkeys created\n\nIt creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nRegistry entries deleted\nThis virus deletes entries in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nRegistry entries modified (final values given)\nIt also modifies the following registry entries:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\n\n3.2 Process injection\nW32.Sality will not inject into processes that belong to the system, the local service or the network service. However, it does inject complex code instructions into other processes, allowing the code to load external DLLs that are downloaded from remote servers into target processes. This virus uses a named mutex based on the injected process ID (PID) for each injection so that it avoid repeatedly injecting code into the same processes.\n\n\n3.3 Lowers security\nThe virus attempts to prevent the compromised computer from starting into Safe Mode by deleting all entries located in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\n\nThe virus starts the Windows IP Filter Driver service and drops an embedded driver to the following location:\n%System%\\drivers\\[RANDOM FILE NAME]\n\nIt then creates and starts a service to load the driver. The driver blocks access to a variety of security software vendor web sites.\n\nThe virus then disables security software services and ends security software processes. It also disables registry editing and the task manager.\n\n\n3.4 Infection Functionality\nThis virus checks that a file is not protected by the Windows file protection mechanism (SFC) before trying to infect it. It then infects unprotected executable files on local, removable and remote shared drives. At the entry point of the executable, it replaces the original host code to redirect execution to the polymorphic viral code located in the last section of the host file.\n\nIt also infects executables connected to the registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n3.5 Downloader capabilities\nThe virus downloads and executes a variety of files including pay per install executables such as misleading applications. The flexibility of the downloader functionality lies in the continuous exchange of URL lists.\n\nW32.Sality also contains an initial list of URLs to download and execute and may receive new URLs from other infected peers.\n\nIt will either directly download, decrypt, and execute the specified binary or download a list of URLs, then download, decrypt, or execute each URL in the list.\n\n\n3.6 Network Activity\nW32.Sality participates in a peer-to-peer botnet using UDP. A variable listening port is generated (minimum 2199) based on the computer name and current executable file name and in some cases defaults to 9674.\n\nIt also contains a preconfigured list of up to 1000 peers (IP address and UDP port pairs). The goal of the P2P network is to exchange lists of URLs to feed to the downloader functionality. The P2P protocol offers only a few commands, the most important being:\nAsk a peer for its list of URLs\nGive a peer its own URL package\nAsk a peer to send the IP address and port of another peer in the botnet, in order to keep the list of peers up-to-date\nAll the peer-to-peer traffic is encrypted by means of RC4 encryption using static hard-coded keys.\n\nDownloading\nThe virus downloads files based on predetermined URLs contained in exchanged lists. These files can include additional malware threats and pay per install applications. It is possible that downloaded files may be updated versions of the virus.\n\nUploading\nW32.Sality will upload its own URL package to a peer.\n\n\nOther network activity\nNone\n\n\n4. ADDITIONAL INFORMATION\nFor more information relating to this threat family, please see the following resources:\n\nBlog Entries on W32.Sality\nSality: Story of a Peer-to-Peer Viral Network (Whitepaper - July 2011)\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\n1. Prevention and avoidance\n1.1 User behavior and precautions\n1.2 Patch operating system and software\n1.3 Address blocking\n1.4 Network port blocking\n1.5 Network shares\n2. Infection method\n2.1 Network shares\n3. Functionality\n3.1 System modifications\n3.2 Process injection\n3.3 Lowers security settings\n3.4 Infection Functionality\n3.5 Downloader capabilities\n3.6 Network activity\n4. Additional information\n\n\n\n1. PREVENTION AND AVOIDANCE\nThe following actions can be taken to avoid or minimize the risk from this threat.\n\n\n1.1 User behavior and precautions\nUsers are advised not to open or execute files from unknown sources.\n\nIt is also advisable to disconnect removable drives when not required. If write access is not required, enable the read only mode if the option is available.\n\nUsers should disable AutoPlay to prevent automatic launching of executable files on removable drives. More information may be found by reading this article: How to prevent a virus from spreading using the 'AutoRun' feature.\n\nUsers should turn off file sharing if its use is not required. If file sharing is required, users should use ACLs and password protection to limit access. In addition to this, the use of a firewall or IDS may block or detect back door server communications with remote client applications.\n\n\n1.2 Patch operating system and software\nUsers are advised to ensure that their operating systems and any installed software are fully patched, and antivirus and firewall software are up to date and operational. It is also recommended that users turn on automatic updates if available so that their computers can receive the latest patches and updates when they are made available.\n\n\n1.3 Address blocking\nWhile the domains will vary with new variants, we have recently observed the following domains in use. Block access to the following addresses using a firewall, router or add entries to the local hosts files to redirect the following addresses to 127.0.0.1:\n89.119.67.154\nbalsfhkewo7i487fksd.info\nbcash-ddt.net\nbclr-cash.net\nbddr-cash.net\nbmakemegood24.com\nbmoney-frn.net\nbperfectchoice1.com\nbpowqbvcfds677.info\nbtrn-cash.net\nbuynvf96.info\nbxxxl-cash.net\nkjwre77638dfqwieuoi.info\nkjwre9fqwieluoi.info\nkukutrustnet777.info\nkukutrustnet888.info\nkukutrustnet987.info\noceaninfo.co.kr\npedmeo222nb.info\npzrk.ru\ntechnican.w.interia.pl\n\n\n1.4 Network port blocking\nThe virus generates a random listening port based on the computer name and current executable file name, but may also use a default port. Blocking the following default port at network perimeter will help to reduce the risk to your computer:\nUDP port 9674\n\n\n1.5 Network shares\nThis threat is also known to spread inside large network by using shares, the following steps can help protect your computer against this threat.\nUsers are advised to ensure that all network shares are only opened when they are necessary for use.\nUse a strong password to guard any shared folders or accounts. A strong password is a password that is of sufficient length of 8 or more characters. The password should also use a combination of numeric, capital, lowercase characters and symbols. Commonly used words from everyday language should not be used as they may easily be defeated by a dictionary attack.\nDisable the autorun feature to prevent dropped files from running automatically when a network drive is opened.\nFor more information about the autorun feature and how to disable it, please review this blog entry.\n\n\n\n2. INFECTION METHOD\nW32.Sality will infect executable files on local, removable and remote shared drives. W32.Sality replaces the original host code at the entry point of the executable to redirect execution to the polymorphic viral code, which has been inserted in the last section of the host file.\n\n\n\nIn addition to infecting local and remotely shared executable files, W32.Sality will purposely search for the following registry subkeys to infect the executables associated with that subkey, including those executables that run when Windows starts:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n2.1 Network shares\nW32.Sality may iterate all available network shares and infect executable files on the remote shares.\n\n\n\n3. FUNCTIONALITY\nW32.Sality has five main areas of functionality, aside from System modifications, that we\u2019ll cover more in-depth below.\nInjects itself into processes so it is able to load downloaded DLLs into target processes.\nCompromises security settings\nInfects files on local drives and removable media\nDownloads files and URLs\nCreates a peer-to-peer (P2P) botnet\nSystem modifications made by the virus create side effects on the compromised computer.\n\nNote: Side effects created by associated threats are not included in this report.\n\n\n3.1 SYSTEM MODIFICATIONS\nThe following side effects may be observed on computers compromised by members of threat family.\n\nFiles created\n%System%\\drivers\\[RANDOM FILE NAME]\n\nFiles or folders deleted\nNone\n\nFiles or folders modified\nNone\n\nRegistry subkeys created\n\nIt creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nRegistry entries deleted\nThis virus deletes entries in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nRegistry entries modified (final values given)\nIt also modifies the following registry entries:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\n\n3.2 Process injection\nW32.Sality will not inject into processes that belong to the system, the local service or the network service. However, it does inject complex code instructions into other processes, allowing the code to load external DLLs that are downloaded from remote servers into target processes. This virus uses a named mutex based on the injected process ID (PID) for each injection so that it avoid repeatedly injecting code into the same processes.\n\n\n3.3 Lowers security\nThe virus attempts to prevent the compromised computer from starting into Safe Mode by deleting all entries located in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\n\nThe virus starts the Windows IP Filter Driver service and drops an embedded driver to the following location:\n%System%\\drivers\\[RANDOM FILE NAME]\n\nIt then creates and starts a service to load the driver. The driver blocks access to a variety of security software vendor web sites.\n\nThe virus then disables security software services and ends security software processes. It also disables registry editing and the task manager.\n\n\n3.4 Infection Functionality\nThis virus checks that a file is not protected by the Windows file protection mechanism (SFC) before trying to infect it. It then infects unprotected executable files on local, removable and remote shared drives. At the entry point of the executable, it replaces the original host code to redirect execution to the polymorphic viral code located in the last section of the host file.\n\nIt also infects executables connected to the registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n3.5 Downloader capabilities\nThe virus downloads and executes a variety of files including pay per install executables such as misleading applications. The flexibility of the downloader functionality lies in the continuous exchange of URL lists.\n\nW32.Sality also contains an initial list of URLs to download and execute and may receive new URLs from other infected peers.\n\nIt will either directly download, decrypt, and execute the specified binary or download a list of URLs, then download, decrypt, or execute each URL in the list.\n\n\n3.6 Network Activity\nW32.Sality participates in a peer-to-peer botnet using UDP. A variable listening port is generated (minimum 2199) based on the computer name and current executable file name and in some cases defaults to 9674.\n\nIt also contains a preconfigured list of up to 1000 peers (IP address and UDP port pairs). The goal of the P2P network is to exchange lists of URLs to feed to the downloader functionality. The P2P protocol offers only a few commands, the most important being:\nAsk a peer for its list of URLs\nGive a peer its own URL package\nAsk a peer to send the IP address and port of another peer in the botnet, in order to keep the list of peers up-to-date\nAll the peer-to-peer traffic is encrypted by means of RC4 encryption using static hard-coded keys.\n\nDownloading\nThe virus downloads files based on predetermined URLs contained in exchanged lists. These files can include additional malware threats and pay per install applications. It is possible that downloaded files may be updated versions of the virus.\n\nUploading\nW32.Sality will upload its own URL package to a peer.\n\n\nOther network activity\nNone\n\n\n4. ADDITIONAL INFORMATION\nFor more information relating to this threat family, please see the following resources:\n\nBlog Entries on W32.Sality\nSality: Story of a Peer-to-Peer Viral Network (Whitepaper - July 2011)\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n"
        },
        {
            "summary": "Discovered:\nAugust 31, 2010\nUpdated:\nNovember 2, 2012 2:36:20 PM\nType:\nTrojan\nSystems Affected:\nWindows\nW32.Sality!dr is a detection for a Trojan horse that is dropped by variants of W32.Sality.\n\nFor more information, please see the following resource:\nW32.Sality\nAntivirus Protection Dates\nInitial Rapid Release version pending\nLatest Rapid Release version October 17, 2017 revision 019\nInitial Daily Certified version September 1, 2010 revision 002\nLatest Daily Certified version October 18, 2017 revision 006\nInitial Weekly Certified release date September 1, 2010\n",
            "tech": "Discovered:\nAugust 31, 2010\nUpdated:\nNovember 2, 2012 2:36:20 PM\nType:\nTrojan\nSystems Affected:\nWindows\nW32.Sality!dr is a detection for a Trojan horse that is dropped by variants of W32.Sality.\n\nFiles that are detected as W32.Sality!dr may be malicious. We suggest that you submit any such files to Symantec Security Response. For instructions on how to do this using Scan and Deliver, read Submit Virus Samples.\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nAugust 31, 2010\nUpdated:\nNovember 2, 2012 2:36:20 PM\nType:\nTrojan\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n"
        },
        {
            "summary": "Discovered:\nJune 29, 2006\nUpdated:\nNovember 2, 2012 12:29:32 PM\nAlso Known As:\nW32/Sality-V [Sophos]\nSystems Affected:\nWindows\nW32.Sality.S is a virus that spreads by infecting executable files.\n\nFor more information, please see the following resources:\nW32.Sality\nAntivirus Protection Dates\nInitial Rapid Release version June 29, 2006\nLatest Rapid Release version September 28, 2010 revision 054\nInitial Daily Certified version June 29, 2006\nLatest Daily Certified version September 28, 2010 revision 036\nInitial Weekly Certified release date July 5, 2006\n",
            "tech": "Discovered:\nJune 29, 2006\nUpdated:\nNovember 2, 2012 12:29:32 PM\nAlso Known As:\nW32/Sality-V [Sophos]\nSystems Affected:\nWindows\nW32.Sality.S is a virus that spreads by infecting executable files.\n\nWhen the threat is first installed, it drops the following file:\n%System%\\vcmgrd32.dll\n\nThe threat injects this .dll file into all running processes.\n\nThe threat then resides in memory and infects all portable executable files it finds.\n",
            "symptoms": "Discovered:\nJune 29, 2006\nUpdated:\nNovember 2, 2012 12:29:32 PM\nAlso Known As:\nW32/Sality-V [Sophos]\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n"
        },
        {
            "summary": "Discovered:\nApril 20, 2008\nUpdated:\nAugust 10, 2008 11:06:05 AM\nAlso Known As:\nW32/Sality.AA [F-Secure], Win32/Sality.AA [Computer Associates], Win32/Sality.Z [Computer Associates], Sality.AG [Panda Software], W32/Sality.ae [McAfee], TROJ_AGENT.XOO [Trend]\nType:\nVirus\nInfection Length:\n57,344 bytes\nSystems Affected:\nWindows\nWhen the virus is executed, it copies itself as the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nThe virus creates the following mutex so only one instance of the virus is running:\nOp1mutx9\n\nIt then creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nIt then creates the following registry entry so that it bypasses the Windows Firewall:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\n\nIt modifies the following registry entries:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\nThe virus also deletes entries under the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nIt then registers itself as a new service with the following characteristics:\nService Name: WMI_MFC_TPSHOKER_80\nDisplay Name: WMI_MFC_TPSHOKER_80\nStartup Type: Automatic\n\nIt then deletes the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nIt stops the following services:\nALG\naswUpdSv\navast! Antivirus\navast! Mail Scanner\navast! Web Scanner\nAVP\nBackWeb Plug-in - 4476822\nbdss\nBGLiveSvc\nBlackICE\nCAISafe\nccEvtMgr\nccProxy\nccSetMgr\nF-Prot Antivirus Update Monitor\nfsbwsys\nFSDFWD\nF-Secure Gatekeeper Handler Starter\nfshttps\nFSMA\nInoRPC\nInoRT\nInoTask\nISSVC\nKPF4\nLavasoftFirewall\nLIVESRV\nMcAfeeFramework\nMcShield\nMcTaskManager\nnavapsvc\nNOD32krn\nNPFMntor\nNSCService\nOutpost Firewall main module\nOutpostFirewall\nPAVFIRES\nPAVFNSVR\nPavProt\nPavPrSrv\nPAVSRV\nPcCtlCom\nPersonalFirewal\nPREVSRV\nProtoPort Firewall service\nPSIMSVC\nRapApp\nSmcService\nSNDSrvc\nSPBBCSvc\nSymantec Core LC\nTmntsrv\nTmPfw\ntmproxy\nUmxAgent\nUmxCfg\nUmxLU\nUmxPol\nvsmon\nVSSERV\nWebrootDesktopFirewallDataService\nWebrootFirewall\nXCOMM\n\nIt infects all executable files listed under the following registry subkey:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\n\nIt infects all .exe executable files listed under the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nIt also infects all .exe and .scr files on the C drive and on any writable network resource, except the files on any folder with the following strings:\nSYSTEM\nAHEAD\n\nThe infected file size will increase 57,344 bytes.\n\nIt deletes any file whose name contains any of the following strings:\n.VDB\n.AVC\n.KEY\ndrw\n_AVPM\nA2GUARD\nAAVSHIELD\nAVAST\nADVCHK\nAHNSD\nAIRDEFENSE\nALERTSVC\nALMON\nALOGSERV\nALSVC\nAMON\nANTI-TROJAN\nAVZ\nANTIVIR\nANTS\nAPVXDWIN\nARMOR2NET\nASHAVAST\nASHDISP\nASHENHCD\nASHMAISV\nASHPOPWZ\nASHSERV\nASHSIMPL\nASHSKPCK\nASHWEBSV\nASWUPDSV\nATCON\nATUPDATER\nATWATCH\nAUPDATE\nAUTODOWN\nAUTOTRACE\nAUTOUPDATE\nAVCIMAN\nAVCONSOL\nAVENGINE\nAVGAMSVR\nAVGCC\nAVGCC32\nAVGCTRL\nAVGEMC\nAVGFWSRV\nAVGNT\nAVGNTDD\nAVGNTMGR\nAVGSERV\nAVGUARD\nAVGUPSVC\nAVINITNT\nAVKSERV\nAVKSERVICE\nAVKWCTL\nAVP\nAVP32\nAVPCC\nAVPM\nAVPUPD\nAVSCHED32\nAVSYNMGR\nAVWUPD32\nAVWUPSRV\nAVXMONITOR9X\nAVXMONITORNT\nAVXQUAR\nBACKWEB-4476822\nBDMCON\nBDNEWS\nBDOESRV\nBDSS\nBDSUBMIT\nBDSWITCH\nBLACKD\nBLACKICE\nCAFIX\nCCAPP\nCCEVTMGR\nCCPROXY\nCCSETMGR\nCFIAUDIT\nCLAMTRAY\nCLAMWIN\nCLAW95\nCLAW95CF\nCLEANER\nCLEANER3\nCLISVC\nCMGRDIAN\nCUREIT\nDEFWATCH\nDOORS\nDRVIRUS\nDRWADINS\nDRWEB32W\nDRWEBSCD\nDRWEBUPW\nESCANH95\nESCANHNT\nEWIDOCTRL\nEZANTIVIRUSREGISTRATIONCHECK\nF-AGNT95\nFAMEH32\nFAST\nFCH32\nFILEMON\nFIRESVC\nFIRETRAY\nFIREWALL\nFPAVUPDM\nF-PROT95\nFRESHCLAM\nFRW\nFSAV32\nFSAVGUI\nFSBWSYS\nF-SCHED\nFSDFWD\nFSGK32\nFSGK32ST\nFSGUIEXE\nFSM32\nFSMA32\nFSMB32\nFSPEX.\nFSSM32\nF-STOPW\nGCASDTSERV\nGCASSERV\nGIANTANTISPYWAREMAIN\nGIANTANTISPYWAREUPDATER\nGUARDGUI\nGUARDNT\nHREGMON\nHRRES\nHSOCKPE\nHUPDATE\nIAMAPP\nIAMSERV\nICLOAD95\nICLOADNT\nICMON\nICSSUPPNT\nICSUPP95\nICSUPPNT\nIFACE\nINETUPD\nINOCIT\nINORPC\nINORT\nINOTASK\nINOUPTNG\nIOMON98\nISAFE\nISATRAY\nISRV95\nISSVC\nKAV\nKAVMM\nKAVPF\nKAVPFW\nKAVSTART\nKAVSVC\nKAVSVCUI\nKMAILMON\nKPFWSVC\nKWATCH\nLOCKDOWN2000\nLOGWATNT\nLUALL\nLUCOMSERVER\nLUUPDATE\nMCAGENT\nMCMNHDLR\nMCREGWIZ\nMCUPDATE\nMCVSSHLD\nMINILOG\nMYAGTSVC\nMYAGTTRY\nNAVAPSVC\nNAVAPW32\nNAVLU32\nNAVW32\nNOD32\nNEOWATCHLOG\nNEOWATCHTRAY\nNISSERV\nNISUM\nNMAIN\nNOD32\nNORMIST\nNOTSTART\nNPAVTRAY\nNPFMNTOR\nNPFMSG\nNPROTECT\nNSCHED32\nNSMDTR\nNSSSERV\nNSSTRAY\nNTRTSCAN\nNTXCONFIG\nNUPGRADE\nNVC95\nNVCOD\nNVCTE\nNVCUT\nNWSERVICE\nOFCPFWSVC\nOUTPOST\nPAV\nPAVFIRES\nPAVFNSVR\nPAVKRE\nPAVPROT\nPAVPROXY\nPAVPRSRV\nPAVSRV51\nPAVSS\nPCCGUIDE\nPCCIOMON\nPCCNTMON\nPCCPFW\nPCCTLCOM\nPCTAV\nPERSFW\nPERTSK\nPERVAC\nPNMSRV\nPOP3TRAP\nPOPROXY\nPREVSRV\nPSIMSVC\nQHM32\nQHONLINE\nQHONSVC\nQHPF\nQHWSCSVC\nRAVMON\nRAVTIMER\nREALMON\nREALMON95\nRFWMAIN\nRTVSCAN\nRTVSCN95\nRULAUNCH\nSAVADMINSERVICE\nSAVMAIN\nSAVPROGRESS\nSAVSCAN\nSCAN32\nSCANNINGPROCESS\nCUREIT\nSDHELP\nSHSTAT\nSITECLI\nSPBBCSVC\nSPHINX\nSPIDERML\nSPIDERNT\nSPIDERUI\nSPYBOTSD\nSPYXX\nSS3EDIT\nSTOPSIGNAV\nSWAGENT\nSWDOCTOR\nSWNETSUP\nSYMLCSVC\nSYMPROXYSVC\nSYMSPORT\nSYMWSC\nSYNMGR\nTAUMON\nTBMON\nTC\nTCA\nTCM\nTDS-3\nTEATIMER\nTFAK\nTHAV\nTHSM\nTMAS\nTMLISTEN\nTMNTSRV\nTMPFW\nTMPROXY\nTNBUTIL\nTRJSCAN\nUP2DATE\nVBA32ECM\nVBA32IFS\nVBA32LDR\nVBA32PP3\nVBSNTW\nVCHK\nVCRMON\nVETTRAY\nVIRUSKEEPER\nVPTRAY\nVRFWSVC\nVRMONNT\nVRMONSVC\nVRRW32\nVSECOMR\nVSHWIN32\nVSMON\nVSSERV\nVSSTAT\nWATCHDOG\nWEBPROXY\nWEBSCANX\nWEBTRAP\nWGFE95\nWINAW32\nWINROUTE\nWINSS\nWINSSNOTIFY\nWRADMIN\nWRCTRL\nXCOMMSVR\nZATUTOR\nZAUINST\nZLCLIENT\nZONEALARM\n\nIt connects to the following URLs to get instructions. The instructions contain additional URLs to possibly download other malicious files:\n[http://]pedmeo222nb.info\n[http://]pzrk.ru\n[http://]technican.w.interia.pl\n[http://]www.kjwre9fqwieluoi.info\n[http://]bpowqbvcfds677.info\n[http://]bmakemegood24.com\n[http://]bperfectchoice1.com\n[http://]bcash-ddt.net\n[http://]bddr-cash.net\n[http://]btrn-cash.net\n[http://]bmoney-frn.net\n[http://]bclr-cash.net\n[http://]bxxxl-cash.net\n[http://]balsfhkewo7i487fksd.info\n[http://]buynvf96.info\n[http://]89.119.67.154/tes[REMOVED]\n[http://]oceaninfo.co.kr/picas[REMOVED]\n[http://]kukutrustnet777.info/home[REMOVED]\n[http://]kukutrustnet888.info/home[REMOVED]\n[http://]kukutrustnet987.info/home[REMOVED]\n[http://]kukutrustnet777.info\n[http://]www.kjwre9fqwieluoi.info\n[http://]kjwre77638dfqwieuoi.info\n\n\nIt prevents access to various security-related domains containing any of the following strings:\nCureit\nDrweb\nOnlinescan\nSpywareinfo\nEwido\nVirusscan\nWindowsecurity\nSpywareguide\nBitdefender\nPanda software\nAgnmitum\nVirustotal\nSophos\nTrend Micro\nEtrust.com\nSymantec\nMcAfee\nF-Secure\nEset.com\nKaspersky\n\nIt adds the following entry to %Windir%\\system.ini:\n[MCIDRV_VER]\n\nIt then copies itself to attached removable drives using the following filenames:\n%DriveLetter%:\\[RANDOM NAME].exe\n%DriveLetter%:\\[RANDOM NAME].cmd\n%DriveLetter%:\\[RANDOM NAME].pif\n\nThe following file is created on attached removable drives so that the threat runs whenever the drive is connected to a computer:\n%DriveLetter%:\\autorun.inf\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "tech": "Discovered:\nApril 20, 2008\nUpdated:\nAugust 10, 2008 11:06:05 AM\nAlso Known As:\nW32/Sality.AA [F-Secure], Win32/Sality.AA [Computer Associates], Win32/Sality.Z [Computer Associates], Sality.AG [Panda Software], W32/Sality.ae [McAfee], TROJ_AGENT.XOO [Trend]\nType:\nVirus\nInfection Length:\n57,344 bytes\nSystems Affected:\nWindows\nWhen the virus is executed, it copies itself as the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nThe virus creates the following mutex so only one instance of the virus is running:\nOp1mutx9\n\nIt then creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nIt then creates the following registry entry so that it bypasses the Windows Firewall:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\n\nIt modifies the following registry entries:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\nThe virus also deletes entries under the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nIt then registers itself as a new service with the following characteristics:\nService Name: WMI_MFC_TPSHOKER_80\nDisplay Name: WMI_MFC_TPSHOKER_80\nStartup Type: Automatic\n\nIt then deletes the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nIt stops the following services:\nALG\naswUpdSv\navast! Antivirus\navast! Mail Scanner\navast! Web Scanner\nAVP\nBackWeb Plug-in - 4476822\nbdss\nBGLiveSvc\nBlackICE\nCAISafe\nccEvtMgr\nccProxy\nccSetMgr\nF-Prot Antivirus Update Monitor\nfsbwsys\nFSDFWD\nF-Secure Gatekeeper Handler Starter\nfshttps\nFSMA\nInoRPC\nInoRT\nInoTask\nISSVC\nKPF4\nLavasoftFirewall\nLIVESRV\nMcAfeeFramework\nMcShield\nMcTaskManager\nnavapsvc\nNOD32krn\nNPFMntor\nNSCService\nOutpost Firewall main module\nOutpostFirewall\nPAVFIRES\nPAVFNSVR\nPavProt\nPavPrSrv\nPAVSRV\nPcCtlCom\nPersonalFirewal\nPREVSRV\nProtoPort Firewall service\nPSIMSVC\nRapApp\nSmcService\nSNDSrvc\nSPBBCSvc\nSymantec Core LC\nTmntsrv\nTmPfw\ntmproxy\nUmxAgent\nUmxCfg\nUmxLU\nUmxPol\nvsmon\nVSSERV\nWebrootDesktopFirewallDataService\nWebrootFirewall\nXCOMM\n\nIt infects all executable files listed under the following registry subkey:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\n\nIt infects all .exe executable files listed under the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nIt also infects all .exe and .scr files on the C drive and on any writable network resource, except the files on any folder with the following strings:\nSYSTEM\nAHEAD\n\nThe infected file size will increase 57,344 bytes.\n\nIt deletes any file whose name contains any of the following strings:\n.VDB\n.AVC\n.KEY\ndrw\n_AVPM\nA2GUARD\nAAVSHIELD\nAVAST\nADVCHK\nAHNSD\nAIRDEFENSE\nALERTSVC\nALMON\nALOGSERV\nALSVC\nAMON\nANTI-TROJAN\nAVZ\nANTIVIR\nANTS\nAPVXDWIN\nARMOR2NET\nASHAVAST\nASHDISP\nASHENHCD\nASHMAISV\nASHPOPWZ\nASHSERV\nASHSIMPL\nASHSKPCK\nASHWEBSV\nASWUPDSV\nATCON\nATUPDATER\nATWATCH\nAUPDATE\nAUTODOWN\nAUTOTRACE\nAUTOUPDATE\nAVCIMAN\nAVCONSOL\nAVENGINE\nAVGAMSVR\nAVGCC\nAVGCC32\nAVGCTRL\nAVGEMC\nAVGFWSRV\nAVGNT\nAVGNTDD\nAVGNTMGR\nAVGSERV\nAVGUARD\nAVGUPSVC\nAVINITNT\nAVKSERV\nAVKSERVICE\nAVKWCTL\nAVP\nAVP32\nAVPCC\nAVPM\nAVPUPD\nAVSCHED32\nAVSYNMGR\nAVWUPD32\nAVWUPSRV\nAVXMONITOR9X\nAVXMONITORNT\nAVXQUAR\nBACKWEB-4476822\nBDMCON\nBDNEWS\nBDOESRV\nBDSS\nBDSUBMIT\nBDSWITCH\nBLACKD\nBLACKICE\nCAFIX\nCCAPP\nCCEVTMGR\nCCPROXY\nCCSETMGR\nCFIAUDIT\nCLAMTRAY\nCLAMWIN\nCLAW95\nCLAW95CF\nCLEANER\nCLEANER3\nCLISVC\nCMGRDIAN\nCUREIT\nDEFWATCH\nDOORS\nDRVIRUS\nDRWADINS\nDRWEB32W\nDRWEBSCD\nDRWEBUPW\nESCANH95\nESCANHNT\nEWIDOCTRL\nEZANTIVIRUSREGISTRATIONCHECK\nF-AGNT95\nFAMEH32\nFAST\nFCH32\nFILEMON\nFIRESVC\nFIRETRAY\nFIREWALL\nFPAVUPDM\nF-PROT95\nFRESHCLAM\nFRW\nFSAV32\nFSAVGUI\nFSBWSYS\nF-SCHED\nFSDFWD\nFSGK32\nFSGK32ST\nFSGUIEXE\nFSM32\nFSMA32\nFSMB32\nFSPEX.\nFSSM32\nF-STOPW\nGCASDTSERV\nGCASSERV\nGIANTANTISPYWAREMAIN\nGIANTANTISPYWAREUPDATER\nGUARDGUI\nGUARDNT\nHREGMON\nHRRES\nHSOCKPE\nHUPDATE\nIAMAPP\nIAMSERV\nICLOAD95\nICLOADNT\nICMON\nICSSUPPNT\nICSUPP95\nICSUPPNT\nIFACE\nINETUPD\nINOCIT\nINORPC\nINORT\nINOTASK\nINOUPTNG\nIOMON98\nISAFE\nISATRAY\nISRV95\nISSVC\nKAV\nKAVMM\nKAVPF\nKAVPFW\nKAVSTART\nKAVSVC\nKAVSVCUI\nKMAILMON\nKPFWSVC\nKWATCH\nLOCKDOWN2000\nLOGWATNT\nLUALL\nLUCOMSERVER\nLUUPDATE\nMCAGENT\nMCMNHDLR\nMCREGWIZ\nMCUPDATE\nMCVSSHLD\nMINILOG\nMYAGTSVC\nMYAGTTRY\nNAVAPSVC\nNAVAPW32\nNAVLU32\nNAVW32\nNOD32\nNEOWATCHLOG\nNEOWATCHTRAY\nNISSERV\nNISUM\nNMAIN\nNOD32\nNORMIST\nNOTSTART\nNPAVTRAY\nNPFMNTOR\nNPFMSG\nNPROTECT\nNSCHED32\nNSMDTR\nNSSSERV\nNSSTRAY\nNTRTSCAN\nNTXCONFIG\nNUPGRADE\nNVC95\nNVCOD\nNVCTE\nNVCUT\nNWSERVICE\nOFCPFWSVC\nOUTPOST\nPAV\nPAVFIRES\nPAVFNSVR\nPAVKRE\nPAVPROT\nPAVPROXY\nPAVPRSRV\nPAVSRV51\nPAVSS\nPCCGUIDE\nPCCIOMON\nPCCNTMON\nPCCPFW\nPCCTLCOM\nPCTAV\nPERSFW\nPERTSK\nPERVAC\nPNMSRV\nPOP3TRAP\nPOPROXY\nPREVSRV\nPSIMSVC\nQHM32\nQHONLINE\nQHONSVC\nQHPF\nQHWSCSVC\nRAVMON\nRAVTIMER\nREALMON\nREALMON95\nRFWMAIN\nRTVSCAN\nRTVSCN95\nRULAUNCH\nSAVADMINSERVICE\nSAVMAIN\nSAVPROGRESS\nSAVSCAN\nSCAN32\nSCANNINGPROCESS\nCUREIT\nSDHELP\nSHSTAT\nSITECLI\nSPBBCSVC\nSPHINX\nSPIDERML\nSPIDERNT\nSPIDERUI\nSPYBOTSD\nSPYXX\nSS3EDIT\nSTOPSIGNAV\nSWAGENT\nSWDOCTOR\nSWNETSUP\nSYMLCSVC\nSYMPROXYSVC\nSYMSPORT\nSYMWSC\nSYNMGR\nTAUMON\nTBMON\nTC\nTCA\nTCM\nTDS-3\nTEATIMER\nTFAK\nTHAV\nTHSM\nTMAS\nTMLISTEN\nTMNTSRV\nTMPFW\nTMPROXY\nTNBUTIL\nTRJSCAN\nUP2DATE\nVBA32ECM\nVBA32IFS\nVBA32LDR\nVBA32PP3\nVBSNTW\nVCHK\nVCRMON\nVETTRAY\nVIRUSKEEPER\nVPTRAY\nVRFWSVC\nVRMONNT\nVRMONSVC\nVRRW32\nVSECOMR\nVSHWIN32\nVSMON\nVSSERV\nVSSTAT\nWATCHDOG\nWEBPROXY\nWEBSCANX\nWEBTRAP\nWGFE95\nWINAW32\nWINROUTE\nWINSS\nWINSSNOTIFY\nWRADMIN\nWRCTRL\nXCOMMSVR\nZATUTOR\nZAUINST\nZLCLIENT\nZONEALARM\n\nIt connects to the following URLs to get instructions. The instructions contain additional URLs to possibly download other malicious files:\n[http://]pedmeo222nb.info\n[http://]pzrk.ru\n[http://]technican.w.interia.pl\n[http://]www.kjwre9fqwieluoi.info\n[http://]bpowqbvcfds677.info\n[http://]bmakemegood24.com\n[http://]bperfectchoice1.com\n[http://]bcash-ddt.net\n[http://]bddr-cash.net\n[http://]btrn-cash.net\n[http://]bmoney-frn.net\n[http://]bclr-cash.net\n[http://]bxxxl-cash.net\n[http://]balsfhkewo7i487fksd.info\n[http://]buynvf96.info\n[http://]89.119.67.154/tes[REMOVED]\n[http://]oceaninfo.co.kr/picas[REMOVED]\n[http://]kukutrustnet777.info/home[REMOVED]\n[http://]kukutrustnet888.info/home[REMOVED]\n[http://]kukutrustnet987.info/home[REMOVED]\n[http://]kukutrustnet777.info\n[http://]www.kjwre9fqwieluoi.info\n[http://]kjwre77638dfqwieuoi.info\n\n\nIt prevents access to various security-related domains containing any of the following strings:\nCureit\nDrweb\nOnlinescan\nSpywareinfo\nEwido\nVirusscan\nWindowsecurity\nSpywareguide\nBitdefender\nPanda software\nAgnmitum\nVirustotal\nSophos\nTrend Micro\nEtrust.com\nSymantec\nMcAfee\nF-Secure\nEset.com\nKaspersky\n\nIt adds the following entry to %Windir%\\system.ini:\n[MCIDRV_VER]\n\nIt then copies itself to attached removable drives using the following filenames:\n%DriveLetter%:\\[RANDOM NAME].exe\n%DriveLetter%:\\[RANDOM NAME].cmd\n%DriveLetter%:\\[RANDOM NAME].pif\n\nThe following file is created on attached removable drives so that the threat runs whenever the drive is connected to a computer:\n%DriveLetter%:\\autorun.inf\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nApril 20, 2008\nUpdated:\nAugust 10, 2008 11:06:05 AM\nAlso Known As:\nW32/Sality.AA [F-Secure], Win32/Sality.AA [Computer Associates], Win32/Sality.Z [Computer Associates], Sality.AG [Panda Software], W32/Sality.ae [McAfee], TROJ_AGENT.XOO [Trend]\nType:\nVirus\nInfection Length:\n57,344 bytes\nSystems Affected:\nWindows\nWhen the virus is executed, it copies itself as the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nThe virus creates the following mutex so only one instance of the virus is running:\nOp1mutx9\n\nIt then creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nIt then creates the following registry entry so that it bypasses the Windows Firewall:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\n\nIt modifies the following registry entries:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\nThe virus also deletes entries under the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nIt then registers itself as a new service with the following characteristics:\nService Name: WMI_MFC_TPSHOKER_80\nDisplay Name: WMI_MFC_TPSHOKER_80\nStartup Type: Automatic\n\nIt then deletes the following file:\n%System%\\drivers\\[RANDOM NAME].sys\n\nIt stops the following services:\nALG\naswUpdSv\navast! Antivirus\navast! Mail Scanner\navast! Web Scanner\nAVP\nBackWeb Plug-in - 4476822\nbdss\nBGLiveSvc\nBlackICE\nCAISafe\nccEvtMgr\nccProxy\nccSetMgr\nF-Prot Antivirus Update Monitor\nfsbwsys\nFSDFWD\nF-Secure Gatekeeper Handler Starter\nfshttps\nFSMA\nInoRPC\nInoRT\nInoTask\nISSVC\nKPF4\nLavasoftFirewall\nLIVESRV\nMcAfeeFramework\nMcShield\nMcTaskManager\nnavapsvc\nNOD32krn\nNPFMntor\nNSCService\nOutpost Firewall main module\nOutpostFirewall\nPAVFIRES\nPAVFNSVR\nPavProt\nPavPrSrv\nPAVSRV\nPcCtlCom\nPersonalFirewal\nPREVSRV\nProtoPort Firewall service\nPSIMSVC\nRapApp\nSmcService\nSNDSrvc\nSPBBCSvc\nSymantec Core LC\nTmntsrv\nTmPfw\ntmproxy\nUmxAgent\nUmxCfg\nUmxLU\nUmxPol\nvsmon\nVSSERV\nWebrootDesktopFirewallDataService\nWebrootFirewall\nXCOMM\n\nIt infects all executable files listed under the following registry subkey:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\n\nIt infects all .exe executable files listed under the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\nIt also infects all .exe and .scr files on the C drive and on any writable network resource, except the files on any folder with the following strings:\nSYSTEM\nAHEAD\n\nThe infected file size will increase 57,344 bytes.\n\nIt deletes any file whose name contains any of the following strings:\n.VDB\n.AVC\n.KEY\ndrw\n_AVPM\nA2GUARD\nAAVSHIELD\nAVAST\nADVCHK\nAHNSD\nAIRDEFENSE\nALERTSVC\nALMON\nALOGSERV\nALSVC\nAMON\nANTI-TROJAN\nAVZ\nANTIVIR\nANTS\nAPVXDWIN\nARMOR2NET\nASHAVAST\nASHDISP\nASHENHCD\nASHMAISV\nASHPOPWZ\nASHSERV\nASHSIMPL\nASHSKPCK\nASHWEBSV\nASWUPDSV\nATCON\nATUPDATER\nATWATCH\nAUPDATE\nAUTODOWN\nAUTOTRACE\nAUTOUPDATE\nAVCIMAN\nAVCONSOL\nAVENGINE\nAVGAMSVR\nAVGCC\nAVGCC32\nAVGCTRL\nAVGEMC\nAVGFWSRV\nAVGNT\nAVGNTDD\nAVGNTMGR\nAVGSERV\nAVGUARD\nAVGUPSVC\nAVINITNT\nAVKSERV\nAVKSERVICE\nAVKWCTL\nAVP\nAVP32\nAVPCC\nAVPM\nAVPUPD\nAVSCHED32\nAVSYNMGR\nAVWUPD32\nAVWUPSRV\nAVXMONITOR9X\nAVXMONITORNT\nAVXQUAR\nBACKWEB-4476822\nBDMCON\nBDNEWS\nBDOESRV\nBDSS\nBDSUBMIT\nBDSWITCH\nBLACKD\nBLACKICE\nCAFIX\nCCAPP\nCCEVTMGR\nCCPROXY\nCCSETMGR\nCFIAUDIT\nCLAMTRAY\nCLAMWIN\nCLAW95\nCLAW95CF\nCLEANER\nCLEANER3\nCLISVC\nCMGRDIAN\nCUREIT\nDEFWATCH\nDOORS\nDRVIRUS\nDRWADINS\nDRWEB32W\nDRWEBSCD\nDRWEBUPW\nESCANH95\nESCANHNT\nEWIDOCTRL\nEZANTIVIRUSREGISTRATIONCHECK\nF-AGNT95\nFAMEH32\nFAST\nFCH32\nFILEMON\nFIRESVC\nFIRETRAY\nFIREWALL\nFPAVUPDM\nF-PROT95\nFRESHCLAM\nFRW\nFSAV32\nFSAVGUI\nFSBWSYS\nF-SCHED\nFSDFWD\nFSGK32\nFSGK32ST\nFSGUIEXE\nFSM32\nFSMA32\nFSMB32\nFSPEX.\nFSSM32\nF-STOPW\nGCASDTSERV\nGCASSERV\nGIANTANTISPYWAREMAIN\nGIANTANTISPYWAREUPDATER\nGUARDGUI\nGUARDNT\nHREGMON\nHRRES\nHSOCKPE\nHUPDATE\nIAMAPP\nIAMSERV\nICLOAD95\nICLOADNT\nICMON\nICSSUPPNT\nICSUPP95\nICSUPPNT\nIFACE\nINETUPD\nINOCIT\nINORPC\nINORT\nINOTASK\nINOUPTNG\nIOMON98\nISAFE\nISATRAY\nISRV95\nISSVC\nKAV\nKAVMM\nKAVPF\nKAVPFW\nKAVSTART\nKAVSVC\nKAVSVCUI\nKMAILMON\nKPFWSVC\nKWATCH\nLOCKDOWN2000\nLOGWATNT\nLUALL\nLUCOMSERVER\nLUUPDATE\nMCAGENT\nMCMNHDLR\nMCREGWIZ\nMCUPDATE\nMCVSSHLD\nMINILOG\nMYAGTSVC\nMYAGTTRY\nNAVAPSVC\nNAVAPW32\nNAVLU32\nNAVW32\nNOD32\nNEOWATCHLOG\nNEOWATCHTRAY\nNISSERV\nNISUM\nNMAIN\nNOD32\nNORMIST\nNOTSTART\nNPAVTRAY\nNPFMNTOR\nNPFMSG\nNPROTECT\nNSCHED32\nNSMDTR\nNSSSERV\nNSSTRAY\nNTRTSCAN\nNTXCONFIG\nNUPGRADE\nNVC95\nNVCOD\nNVCTE\nNVCUT\nNWSERVICE\nOFCPFWSVC\nOUTPOST\nPAV\nPAVFIRES\nPAVFNSVR\nPAVKRE\nPAVPROT\nPAVPROXY\nPAVPRSRV\nPAVSRV51\nPAVSS\nPCCGUIDE\nPCCIOMON\nPCCNTMON\nPCCPFW\nPCCTLCOM\nPCTAV\nPERSFW\nPERTSK\nPERVAC\nPNMSRV\nPOP3TRAP\nPOPROXY\nPREVSRV\nPSIMSVC\nQHM32\nQHONLINE\nQHONSVC\nQHPF\nQHWSCSVC\nRAVMON\nRAVTIMER\nREALMON\nREALMON95\nRFWMAIN\nRTVSCAN\nRTVSCN95\nRULAUNCH\nSAVADMINSERVICE\nSAVMAIN\nSAVPROGRESS\nSAVSCAN\nSCAN32\nSCANNINGPROCESS\nCUREIT\nSDHELP\nSHSTAT\nSITECLI\nSPBBCSVC\nSPHINX\nSPIDERML\nSPIDERNT\nSPIDERUI\nSPYBOTSD\nSPYXX\nSS3EDIT\nSTOPSIGNAV\nSWAGENT\nSWDOCTOR\nSWNETSUP\nSYMLCSVC\nSYMPROXYSVC\nSYMSPORT\nSYMWSC\nSYNMGR\nTAUMON\nTBMON\nTC\nTCA\nTCM\nTDS-3\nTEATIMER\nTFAK\nTHAV\nTHSM\nTMAS\nTMLISTEN\nTMNTSRV\nTMPFW\nTMPROXY\nTNBUTIL\nTRJSCAN\nUP2DATE\nVBA32ECM\nVBA32IFS\nVBA32LDR\nVBA32PP3\nVBSNTW\nVCHK\nVCRMON\nVETTRAY\nVIRUSKEEPER\nVPTRAY\nVRFWSVC\nVRMONNT\nVRMONSVC\nVRRW32\nVSECOMR\nVSHWIN32\nVSMON\nVSSERV\nVSSTAT\nWATCHDOG\nWEBPROXY\nWEBSCANX\nWEBTRAP\nWGFE95\nWINAW32\nWINROUTE\nWINSS\nWINSSNOTIFY\nWRADMIN\nWRCTRL\nXCOMMSVR\nZATUTOR\nZAUINST\nZLCLIENT\nZONEALARM\n\nIt connects to the following URLs to get instructions. The instructions contain additional URLs to possibly download other malicious files:\n[http://]pedmeo222nb.info\n[http://]pzrk.ru\n[http://]technican.w.interia.pl\n[http://]www.kjwre9fqwieluoi.info\n[http://]bpowqbvcfds677.info\n[http://]bmakemegood24.com\n[http://]bperfectchoice1.com\n[http://]bcash-ddt.net\n[http://]bddr-cash.net\n[http://]btrn-cash.net\n[http://]bmoney-frn.net\n[http://]bclr-cash.net\n[http://]bxxxl-cash.net\n[http://]balsfhkewo7i487fksd.info\n[http://]buynvf96.info\n[http://]89.119.67.154/tes[REMOVED]\n[http://]oceaninfo.co.kr/picas[REMOVED]\n[http://]kukutrustnet777.info/home[REMOVED]\n[http://]kukutrustnet888.info/home[REMOVED]\n[http://]kukutrustnet987.info/home[REMOVED]\n[http://]kukutrustnet777.info\n[http://]www.kjwre9fqwieluoi.info\n[http://]kjwre77638dfqwieuoi.info\n\n\nIt prevents access to various security-related domains containing any of the following strings:\nCureit\nDrweb\nOnlinescan\nSpywareinfo\nEwido\nVirusscan\nWindowsecurity\nSpywareguide\nBitdefender\nPanda software\nAgnmitum\nVirustotal\nSophos\nTrend Micro\nEtrust.com\nSymantec\nMcAfee\nF-Secure\nEset.com\nKaspersky\n\nIt adds the following entry to %Windir%\\system.ini:\n[MCIDRV_VER]\n\nIt then copies itself to attached removable drives using the following filenames:\n%DriveLetter%:\\[RANDOM NAME].exe\n%DriveLetter%:\\[RANDOM NAME].cmd\n%DriveLetter%:\\[RANDOM NAME].pif\n\nThe following file is created on attached removable drives so that the threat runs whenever the drive is connected to a computer:\n%DriveLetter%:\\autorun.inf\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n"
        },
        {
            "summary": "Discovered:\nFebruary 24, 2006\nUpdated:\nMay 20, 2010 5:50:01 PM\nSystems Affected:\nWindows\nW32.HLLP.Sality.O is a detection that detects files that are infected by a variant of the W32.Sality family virus.\n\nFor more information, please see the following resources:\nW32.Sality\nAntivirus Protection Dates\nInitial Rapid Release version February 24, 2006\nLatest Rapid Release version August 8, 2016 revision 023\nInitial Daily Certified version February 24, 2006\nLatest Daily Certified version August 9, 2016 revision 001\nInitial Weekly Certified release date March 1, 2006\n",
            "tech": "Discovered:\nFebruary 24, 2006\nUpdated:\nMay 20, 2010 5:50:01 PM\nSystems Affected:\nWindows\nW32.HLLP.Sality.O is a detection that detects files that are infected by a variant of the W32.Sality family virus.\n",
            "symptoms": "Discovered:\nFebruary 24, 2006\nUpdated:\nMay 20, 2010 5:50:01 PM\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n"
        },
        {
            "summary": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n",
            "tech": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\n1. Prevention and avoidance\n1.1 User behavior and precautions\n1.2 Patch operating system and software\n1.3 Address blocking\n1.4 Network port blocking\n1.5 Network shares\n2. Infection method\n2.1 Network shares\n3. Functionality\n3.1 System modifications\n3.2 Process injection\n3.3 Lowers security settings\n3.4 Infection Functionality\n3.5 Downloader capabilities\n3.6 Network activity\n4. Additional information\n\n\n\n1. PREVENTION AND AVOIDANCE\nThe following actions can be taken to avoid or minimize the risk from this threat.\n\n\n1.1 User behavior and precautions\nUsers are advised not to open or execute files from unknown sources.\n\nIt is also advisable to disconnect removable drives when not required. If write access is not required, enable the read only mode if the option is available.\n\nUsers should disable AutoPlay to prevent automatic launching of executable files on removable drives. More information may be found by reading this article: How to prevent a virus from spreading using the 'AutoRun' feature.\n\nUsers should turn off file sharing if its use is not required. If file sharing is required, users should use ACLs and password protection to limit access. In addition to this, the use of a firewall or IDS may block or detect back door server communications with remote client applications.\n\n\n1.2 Patch operating system and software\nUsers are advised to ensure that their operating systems and any installed software are fully patched, and antivirus and firewall software are up to date and operational. It is also recommended that users turn on automatic updates if available so that their computers can receive the latest patches and updates when they are made available.\n\n\n1.3 Address blocking\nWhile the domains will vary with new variants, we have recently observed the following domains in use. Block access to the following addresses using a firewall, router or add entries to the local hosts files to redirect the following addresses to 127.0.0.1:\n89.119.67.154\nbalsfhkewo7i487fksd.info\nbcash-ddt.net\nbclr-cash.net\nbddr-cash.net\nbmakemegood24.com\nbmoney-frn.net\nbperfectchoice1.com\nbpowqbvcfds677.info\nbtrn-cash.net\nbuynvf96.info\nbxxxl-cash.net\nkjwre77638dfqwieuoi.info\nkjwre9fqwieluoi.info\nkukutrustnet777.info\nkukutrustnet888.info\nkukutrustnet987.info\noceaninfo.co.kr\npedmeo222nb.info\npzrk.ru\ntechnican.w.interia.pl\n\n\n1.4 Network port blocking\nThe virus generates a random listening port based on the computer name and current executable file name, but may also use a default port. Blocking the following default port at network perimeter will help to reduce the risk to your computer:\nUDP port 9674\n\n\n1.5 Network shares\nThis threat is also known to spread inside large network by using shares, the following steps can help protect your computer against this threat.\nUsers are advised to ensure that all network shares are only opened when they are necessary for use.\nUse a strong password to guard any shared folders or accounts. A strong password is a password that is of sufficient length of 8 or more characters. The password should also use a combination of numeric, capital, lowercase characters and symbols. Commonly used words from everyday language should not be used as they may easily be defeated by a dictionary attack.\nDisable the autorun feature to prevent dropped files from running automatically when a network drive is opened.\nFor more information about the autorun feature and how to disable it, please review this blog entry.\n\n\n\n2. INFECTION METHOD\nW32.Sality will infect executable files on local, removable and remote shared drives. W32.Sality replaces the original host code at the entry point of the executable to redirect execution to the polymorphic viral code, which has been inserted in the last section of the host file.\n\n\n\nIn addition to infecting local and remotely shared executable files, W32.Sality will purposely search for the following registry subkeys to infect the executables associated with that subkey, including those executables that run when Windows starts:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n2.1 Network shares\nW32.Sality may iterate all available network shares and infect executable files on the remote shares.\n\n\n\n3. FUNCTIONALITY\nW32.Sality has five main areas of functionality, aside from System modifications, that we\u2019ll cover more in-depth below.\nInjects itself into processes so it is able to load downloaded DLLs into target processes.\nCompromises security settings\nInfects files on local drives and removable media\nDownloads files and URLs\nCreates a peer-to-peer (P2P) botnet\nSystem modifications made by the virus create side effects on the compromised computer.\n\nNote: Side effects created by associated threats are not included in this report.\n\n\n3.1 SYSTEM MODIFICATIONS\nThe following side effects may be observed on computers compromised by members of threat family.\n\nFiles created\n%System%\\drivers\\[RANDOM FILE NAME]\n\nFiles or folders deleted\nNone\n\nFiles or folders modified\nNone\n\nRegistry subkeys created\n\nIt creates the following registry subkeys:\nHKEY_CURRENT_USER\\Software\\[USER NAME]914\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_WMI_MFC_TPSHOKER_80\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Enum\\Root\\LEGACY_IPFILTERDRIVER\n\nRegistry entries deleted\nThis virus deletes entries in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Ext\\Stats\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\n\nRegistry entries modified (final values given)\nIt also modifies the following registry entries:\nHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\\"[INFECTED FILE]\" = \"[INFECTED FILE]:*:Enabled:ipsec\"\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Setting\\\"GlobalUserOffline\" = \"0\"\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\system\\\"EnableLUA\" = \"0\"\n\n\n3.2 Process injection\nW32.Sality will not inject into processes that belong to the system, the local service or the network service. However, it does inject complex code instructions into other processes, allowing the code to load external DLLs that are downloaded from remote servers into target processes. This virus uses a named mutex based on the injected process ID (PID) for each injection so that it avoid repeatedly injecting code into the same processes.\n\n\n3.3 Lowers security\nThe virus attempts to prevent the compromised computer from starting into Safe Mode by deleting all entries located in the following registry subkeys:\nHKEY_CURRENT_USER\\System\\CurrentControlSet\\Control\\SafeBoot\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\n\nThe virus starts the Windows IP Filter Driver service and drops an embedded driver to the following location:\n%System%\\drivers\\[RANDOM FILE NAME]\n\nIt then creates and starts a service to load the driver. The driver blocks access to a variety of security software vendor web sites.\n\nThe virus then disables security software services and ends security software processes. It also disables registry editing and the task manager.\n\n\n3.4 Infection Functionality\nThis virus checks that a file is not protected by the Windows file protection mechanism (SFC) before trying to infect it. It then infects unprotected executable files on local, removable and remote shared drives. At the entry point of the executable, it replaces the original host code to redirect execution to the polymorphic viral code located in the last section of the host file.\n\nIt also infects executables connected to the registry subkeys:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n3.5 Downloader capabilities\nThe virus downloads and executes a variety of files including pay per install executables such as misleading applications. The flexibility of the downloader functionality lies in the continuous exchange of URL lists.\n\nW32.Sality also contains an initial list of URLs to download and execute and may receive new URLs from other infected peers.\n\nIt will either directly download, decrypt, and execute the specified binary or download a list of URLs, then download, decrypt, or execute each URL in the list.\n\n\n3.6 Network Activity\nW32.Sality participates in a peer-to-peer botnet using UDP. A variable listening port is generated (minimum 2199) based on the computer name and current executable file name and in some cases defaults to 9674.\n\nIt also contains a preconfigured list of up to 1000 peers (IP address and UDP port pairs). The goal of the P2P network is to exchange lists of URLs to feed to the downloader functionality. The P2P protocol offers only a few commands, the most important being:\nAsk a peer for its list of URLs\nGive a peer its own URL package\nAsk a peer to send the IP address and port of another peer in the botnet, in order to keep the list of peers up-to-date\nAll the peer-to-peer traffic is encrypted by means of RC4 encryption using static hard-coded keys.\n\nDownloading\nThe virus downloads files based on predetermined URLs contained in exchanged lists. These files can include additional malware threats and pay per install applications. It is possible that downloaded files may be updated versions of the virus.\n\nUploading\nW32.Sality will upload its own URL package to a peer.\n\n\nOther network activity\nNone\n\n\n4. ADDITIONAL INFORMATION\nFor more information relating to this threat family, please see the following resources:\n\nBlog Entries on W32.Sality\nSality: Story of a Peer-to-Peer Viral Network (Whitepaper - July 2011)\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nJune 4, 2003\nUpdated:\nAugust 12, 2013 11:28:31 AM\nAlso Known As:\nW32/Kookoo-A [Sophos]\nType:\nVirus\nSystems Affected:\nWindows\nYou may have arrived at this page either because you have been alerted by your Symantec product about this risk, or you are concerned that your computer has been affected by this risk.\n\nBefore proceeding further we recommend that you run a full system scan. If that does not resolve the problem you can try one of the options available below.\n\n\n\nFOR NORTON USERS\nIf you are a Norton product user, we recommend you try the following resources to remove this risk.\n\nRemoval Tool\nRun Norton Power Eraser (NPE)\nNorton Power Eraser did not remove this risk\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resources provide further information and best practices to help reduce the risk of infection.\nOperating system updates to fix vulnerabilities\nFile sharing protection\nDisable Autorun (CD/USB)\nBest practices for instant messaging\nBest practices for browsing the Web\nBest practices for email\n\n\nFOR BUSINESS USERS\nIf you are a Symantec business product user, we recommend you try the following resources to remove this risk.\n\nIdentifying and submitting suspect files\nSubmitting suspicious files to Symantec allows us to ensure that our protection capabilities keep up with the ever-changing threat landscape. Submitted files are analyzed by Symantec Security Response and, where necessary, updated definitions are immediately distributed through LiveUpdate\u2122 to all Symantec end points. This ensures that other computers nearby are protected from attack. The following resources may help in identifying suspicious files for submission to Symantec.\nLocate a sample of a threat\nSubmit a suspicious file to Symantec\n\n\nRemoval Tool\nRun Symantec Power Eraser in Symantec Help (SymHelp)\nAbout Symantec Power Eraser\nSymantec Power Eraser User Guide\n\nIf you have an infected Windows system file, you may need to replace them using from the Windows installation CD.\n\n\nHow to reduce the risk of infection\nThe following resource provides further information and best practices to help reduce the risk of infection.\nProtecting your business network\n\n\n\nMANUAL REMOVAL\nThe following instructions pertain to all current Symantec antivirus products.\n\n1. Performing a full system scan\nHow to run a full system scan using your Symantec product\n\n\n2. Restoring settings in the registry\nMany risks make modifications to the registry, which could impact the functionality or performance of the compromised computer. While many of these modifications can be restored through various Windows components, it may be necessary to edit the registry. See in the Technical Details of this writeup for information about which registry keys were created or modified. Delete registry subkeys and entries created by the risk and return all modified registry entries to their previous values.\n"
        }
    ]
}