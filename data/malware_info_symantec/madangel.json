{
    "name": "madangel",
    "content": [
        {
            "summary": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nW32.Madangel is a worm that spreads through network shares and attempts to infect .exe files. It also lowers security settings and downloads and executes a remote file.\nAntivirus Protection Dates\nInitial Rapid Release version July 7, 2006\nLatest Rapid Release version September 22, 2016 revision 024\nInitial Daily Certified version July 7, 2006\nLatest Daily Certified version September 22, 2016 revision 025\nInitial Weekly Certified release date July 12, 2006\n",
            "tech": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nWhen W32.Madangel is executed, it performs the following actions:\nCreates the following files:\n\n%Windir%\\rundl132.exe - a copy of W32.Madangel\n%Windir%\\Logo1_.exe - a copy of W32.Madangel\n%Windir%\\vDll.dll - a copy of Downloader\n\nNote:\n%System% is a variable that refers to the System folder. By default this is C:\\Windows\\System (Windows 95/98/Me), C:\\Winnt\\System32 (Windows NT/2000), or C:\\Windows\\System32 (Windows XP).\n%CurrentFolder% is a variable that refers to the folder where the risk was originally executed.\n\nChecks for the value:\n\n\"auto\" = \"1\"\n\nto the registry subkey:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Soft\\DownloadWWW\n\nand either creates the infection marker or exits if it is found.\n\nAttempts to stop the following service:\n\nKingsoft AntiVirus Service\n\nInjects its DLL component, vDll.dll, into either iexplorer.exe or explorer.exe.\n\nUsing the DLL component, attempts to download a file from the following location:\n\n[http://]www.wowchian.com/dl[2 LETTERS[REMOVED]\n\nSearches for .exe files to infect in all the drives from C to Y.\n\nPrepends itself to any .exe files that it locates on the computer.\n\nThe worm creates the file _desktop.ini in any any directory it has searched for executable files in. This file has the hidden and system attributes set and it stores the date the worm was executed.\n\nDoes not infect .exe files in folders with the following names:\n\nsystem\nsystem32\nwindows\nDocuments and Settings\nSystem Volume Information\nRecycled\nwinnt\nProgram Files\nWindows NT\nWindowsUpdate\nWindows Media Player\nOutlook Express\nInternet Explorer\nComPlus Applications\nNetMeeting\nCommon Files\nMessenger\nMicrosoft Office\nInstallShield Installation Information\nMSN\nMicrosoft Frontpage\nMovie Maker\nMSN Gaming Zone\n\nMay send ICMP packets containing the string \"Hello,World\" to the following IP addresses:\n\n192.168.0.30\n192.168.8.1\n\nMay also send ICMP packets to IP addresses in the same range as the IP address of the compromised computer.\n\nAttempts to open shared folders with the following names, if any computer responds to the ICMP packet:\n\n\\\\ipc$\n\\\\admin$\n\nTries to open the shared folder using administrator as the username and a blank password. It copies itself to that folder, if it succeeds in opening the shared folder.\n\nEnumerates all the computers and shared folders in the local network. The worm uses a blank username and a blank password to open the shared folders.\n\nSearches for and infects .exe files in the shared folders.\n\n\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nThe following instructions pertain to all current and recent Symantec antivirus products, including the Symantec AntiVirus and Norton AntiVirus product lines.\nDisable System Restore (Windows Me/XP).\nUpdate the virus definitions.\nRun a full system scan.\nFor specific details on each of these steps, read the following instructions.\n\n1. To disable System Restore (Windows Me/XP)\nIf you are running Windows Me or Windows XP, we recommend that you temporarily turn off System Restore. Windows Me/XP uses this feature, which is enabled by default, to restore the files on your computer in case they become damaged. If a virus, worm, or Trojan infects a computer, System Restore may back up the virus, worm, or Trojan on the computer.\n\nWindows prevents outside programs, including antivirus programs, from modifying System Restore. Therefore, antivirus programs or tools cannot remove threats in the System Restore folder. As a result, System Restore has the potential of restoring an infected file on your computer, even after you have cleaned the infected files from all the other locations.\n\nAlso, a virus scan may detect a threat in the System Restore folder even though you have removed the threat.\n\nFor instructions on how to turn off System Restore, read your Windows documentation, or one of the following articles:\nHow to disable or enable Windows Me System Restore\nHow to turn off or turn on Windows XP System Restore\n\nNote: When you are completely finished with the removal procedure and are satisfied that the threat has been removed, reenable System Restore by following the instructions in the aforementioned documents.\n\nFor additional information, and an alternative to disabling Windows Me System Restore, see the Microsoft Knowledge Base article: Antivirus Tools Cannot Clean Infected Files in the _Restore Folder (Article ID: Q263455).\n\n2. To update the virus definitions\nSymantec Security Response fully tests all the virus definitions for quality assurance before they are posted to our servers. There are two ways to obtain the most recent virus definitions:\nRunning LiveUpdate, which is the easiest way to obtain virus definitions:\nIf you use Norton AntiVirus 2006, Symantec AntiVirus Corporate Edition 10.0, or newer products, LiveUpdate definitions are updated daily. These products include newer technology.\nIf you use Norton AntiVirus 2005, Symantec AntiVirus Corporate Edition 9.0, or earlier products, LiveUpdate definitions are updated weekly. The exception is major outbreaks, when definitions are updated more often.\nDownloading the definitions using the Intelligent Updater: The Intelligent Updater virus definitions are posted daily. You should download the definitions from the Symantec Security Response Web site and manually install them. To determine whether definitions for this threat are available by the Intelligent Updater, refer to Virus Definitions (Intelligent Updater).\n\nThe latest Intelligent Updater virus definitions can be obtained here: Intelligent Updater virus definitions. For detailed instructions read the document: How to update virus definition files using the Intelligent Updater.\n\n3. To run a full system scan\nStart your Symantec antivirus program and make sure that it is configured to scan all the files.\nFor Norton AntiVirus consumer products: Read the document: How to configure Norton AntiVirus to scan all files.\nFor Symantec AntiVirus Enterprise products: Read the document: How to verify that a Symantec Corporate antivirus product is set to scan all files.\nRun a full system scan.\nIf any files are detected, follow the instructions displayed by your antivirus program.\n\nImportant: If you are unable to start your Symantec antivirus product or the product reports that it cannot delete a detected file, you may need to stop the risk from running in order to remove it. To do this, run the scan in Safe mode. For instructions, read the document, How to start the computer in Safe Mode. Once you have restarted in Safe mode, run the scan again.\n\nAfter the files are deleted, restart the computer in Normal mode.\n\n\n"
        },
        {
            "summary": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nThe following instructions pertain to all current and recent Symantec antivirus products, including the Symantec AntiVirus and Norton AntiVirus product lines.\nDisable System Restore (Windows Me/XP).\nUpdate the virus definitions.\nRun a full system scan.\nFor specific details on each of these steps, read the following instructions.\n\n1. To disable System Restore (Windows Me/XP)\nIf you are running Windows Me or Windows XP, we recommend that you temporarily turn off System Restore. Windows Me/XP uses this feature, which is enabled by default, to restore the files on your computer in case they become damaged. If a virus, worm, or Trojan infects a computer, System Restore may back up the virus, worm, or Trojan on the computer.\n\nWindows prevents outside programs, including antivirus programs, from modifying System Restore. Therefore, antivirus programs or tools cannot remove threats in the System Restore folder. As a result, System Restore has the potential of restoring an infected file on your computer, even after you have cleaned the infected files from all the other locations.\n\nAlso, a virus scan may detect a threat in the System Restore folder even though you have removed the threat.\n\nFor instructions on how to turn off System Restore, read your Windows documentation, or one of the following articles:\nHow to disable or enable Windows Me System Restore\nHow to turn off or turn on Windows XP System Restore\n\nNote: When you are completely finished with the removal procedure and are satisfied that the threat has been removed, reenable System Restore by following the instructions in the aforementioned documents.\n\nFor additional information, and an alternative to disabling Windows Me System Restore, see the Microsoft Knowledge Base article: Antivirus Tools Cannot Clean Infected Files in the _Restore Folder (Article ID: Q263455).\n\n2. To update the virus definitions\nSymantec Security Response fully tests all the virus definitions for quality assurance before they are posted to our servers. There are two ways to obtain the most recent virus definitions:\nRunning LiveUpdate, which is the easiest way to obtain virus definitions:\nIf you use Norton AntiVirus 2006, Symantec AntiVirus Corporate Edition 10.0, or newer products, LiveUpdate definitions are updated daily. These products include newer technology.\nIf you use Norton AntiVirus 2005, Symantec AntiVirus Corporate Edition 9.0, or earlier products, LiveUpdate definitions are updated weekly. The exception is major outbreaks, when definitions are updated more often.\nDownloading the definitions using the Intelligent Updater: The Intelligent Updater virus definitions are posted daily. You should download the definitions from the Symantec Security Response Web site and manually install them. To determine whether definitions for this threat are available by the Intelligent Updater, refer to Virus Definitions (Intelligent Updater).\n\nThe latest Intelligent Updater virus definitions can be obtained here: Intelligent Updater virus definitions. For detailed instructions read the document: How to update virus definition files using the Intelligent Updater.\n\n3. To run a full system scan\nStart your Symantec antivirus program and make sure that it is configured to scan all the files.\nFor Norton AntiVirus consumer products: Read the document: How to configure Norton AntiVirus to scan all files.\nFor Symantec AntiVirus Enterprise products: Read the document: How to verify that a Symantec Corporate antivirus product is set to scan all files.\nRun a full system scan.\nIf any files are detected, follow the instructions displayed by your antivirus program.\n\nImportant: If you are unable to start your Symantec antivirus product or the product reports that it cannot delete a detected file, you may need to stop the risk from running in order to remove it. To do this, run the scan in Safe mode. For instructions, read the document, How to start the computer in Safe Mode. Once you have restarted in Safe mode, run the scan again.\n\nAfter the files are deleted, restart the computer in Normal mode.\n\n\n",
            "tech": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nThe following instructions pertain to all current and recent Symantec antivirus products, including the Symantec AntiVirus and Norton AntiVirus product lines.\nDisable System Restore (Windows Me/XP).\nUpdate the virus definitions.\nRun a full system scan.\nFor specific details on each of these steps, read the following instructions.\n\n1. To disable System Restore (Windows Me/XP)\nIf you are running Windows Me or Windows XP, we recommend that you temporarily turn off System Restore. Windows Me/XP uses this feature, which is enabled by default, to restore the files on your computer in case they become damaged. If a virus, worm, or Trojan infects a computer, System Restore may back up the virus, worm, or Trojan on the computer.\n\nWindows prevents outside programs, including antivirus programs, from modifying System Restore. Therefore, antivirus programs or tools cannot remove threats in the System Restore folder. As a result, System Restore has the potential of restoring an infected file on your computer, even after you have cleaned the infected files from all the other locations.\n\nAlso, a virus scan may detect a threat in the System Restore folder even though you have removed the threat.\n\nFor instructions on how to turn off System Restore, read your Windows documentation, or one of the following articles:\nHow to disable or enable Windows Me System Restore\nHow to turn off or turn on Windows XP System Restore\n\nNote: When you are completely finished with the removal procedure and are satisfied that the threat has been removed, reenable System Restore by following the instructions in the aforementioned documents.\n\nFor additional information, and an alternative to disabling Windows Me System Restore, see the Microsoft Knowledge Base article: Antivirus Tools Cannot Clean Infected Files in the _Restore Folder (Article ID: Q263455).\n\n2. To update the virus definitions\nSymantec Security Response fully tests all the virus definitions for quality assurance before they are posted to our servers. There are two ways to obtain the most recent virus definitions:\nRunning LiveUpdate, which is the easiest way to obtain virus definitions:\nIf you use Norton AntiVirus 2006, Symantec AntiVirus Corporate Edition 10.0, or newer products, LiveUpdate definitions are updated daily. These products include newer technology.\nIf you use Norton AntiVirus 2005, Symantec AntiVirus Corporate Edition 9.0, or earlier products, LiveUpdate definitions are updated weekly. The exception is major outbreaks, when definitions are updated more often.\nDownloading the definitions using the Intelligent Updater: The Intelligent Updater virus definitions are posted daily. You should download the definitions from the Symantec Security Response Web site and manually install them. To determine whether definitions for this threat are available by the Intelligent Updater, refer to Virus Definitions (Intelligent Updater).\n\nThe latest Intelligent Updater virus definitions can be obtained here: Intelligent Updater virus definitions. For detailed instructions read the document: How to update virus definition files using the Intelligent Updater.\n\n3. To run a full system scan\nStart your Symantec antivirus program and make sure that it is configured to scan all the files.\nFor Norton AntiVirus consumer products: Read the document: How to configure Norton AntiVirus to scan all files.\nFor Symantec AntiVirus Enterprise products: Read the document: How to verify that a Symantec Corporate antivirus product is set to scan all files.\nRun a full system scan.\nIf any files are detected, follow the instructions displayed by your antivirus program.\n\nImportant: If you are unable to start your Symantec antivirus product or the product reports that it cannot delete a detected file, you may need to stop the risk from running in order to remove it. To do this, run the scan in Safe mode. For instructions, read the document, How to start the computer in Safe Mode. Once you have restarted in Safe mode, run the scan again.\n\nAfter the files are deleted, restart the computer in Normal mode.\n\n\n",
            "symptoms": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nThe following instructions pertain to all current and recent Symantec antivirus products, including the Symantec AntiVirus and Norton AntiVirus product lines.\nDisable System Restore (Windows Me/XP).\nUpdate the virus definitions.\nRun a full system scan.\nFor specific details on each of these steps, read the following instructions.\n\n1. To disable System Restore (Windows Me/XP)\nIf you are running Windows Me or Windows XP, we recommend that you temporarily turn off System Restore. Windows Me/XP uses this feature, which is enabled by default, to restore the files on your computer in case they become damaged. If a virus, worm, or Trojan infects a computer, System Restore may back up the virus, worm, or Trojan on the computer.\n\nWindows prevents outside programs, including antivirus programs, from modifying System Restore. Therefore, antivirus programs or tools cannot remove threats in the System Restore folder. As a result, System Restore has the potential of restoring an infected file on your computer, even after you have cleaned the infected files from all the other locations.\n\nAlso, a virus scan may detect a threat in the System Restore folder even though you have removed the threat.\n\nFor instructions on how to turn off System Restore, read your Windows documentation, or one of the following articles:\nHow to disable or enable Windows Me System Restore\nHow to turn off or turn on Windows XP System Restore\n\nNote: When you are completely finished with the removal procedure and are satisfied that the threat has been removed, reenable System Restore by following the instructions in the aforementioned documents.\n\nFor additional information, and an alternative to disabling Windows Me System Restore, see the Microsoft Knowledge Base article: Antivirus Tools Cannot Clean Infected Files in the _Restore Folder (Article ID: Q263455).\n\n2. To update the virus definitions\nSymantec Security Response fully tests all the virus definitions for quality assurance before they are posted to our servers. There are two ways to obtain the most recent virus definitions:\nRunning LiveUpdate, which is the easiest way to obtain virus definitions:\nIf you use Norton AntiVirus 2006, Symantec AntiVirus Corporate Edition 10.0, or newer products, LiveUpdate definitions are updated daily. These products include newer technology.\nIf you use Norton AntiVirus 2005, Symantec AntiVirus Corporate Edition 9.0, or earlier products, LiveUpdate definitions are updated weekly. The exception is major outbreaks, when definitions are updated more often.\nDownloading the definitions using the Intelligent Updater: The Intelligent Updater virus definitions are posted daily. You should download the definitions from the Symantec Security Response Web site and manually install them. To determine whether definitions for this threat are available by the Intelligent Updater, refer to Virus Definitions (Intelligent Updater).\n\nThe latest Intelligent Updater virus definitions can be obtained here: Intelligent Updater virus definitions. For detailed instructions read the document: How to update virus definition files using the Intelligent Updater.\n\n3. To run a full system scan\nStart your Symantec antivirus program and make sure that it is configured to scan all the files.\nFor Norton AntiVirus consumer products: Read the document: How to configure Norton AntiVirus to scan all files.\nFor Symantec AntiVirus Enterprise products: Read the document: How to verify that a Symantec Corporate antivirus product is set to scan all files.\nRun a full system scan.\nIf any files are detected, follow the instructions displayed by your antivirus program.\n\nImportant: If you are unable to start your Symantec antivirus product or the product reports that it cannot delete a detected file, you may need to stop the risk from running in order to remove it. To do this, run the scan in Safe mode. For instructions, read the document, How to start the computer in Safe Mode. Once you have restarted in Safe mode, run the scan again.\n\nAfter the files are deleted, restart the computer in Normal mode.\n\n\n"
        },
        {
            "summary": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nWhen W32.Madangel is executed, it performs the following actions:\nCreates the following files:\n\n%Windir%\\rundl132.exe - a copy of W32.Madangel\n%Windir%\\Logo1_.exe - a copy of W32.Madangel\n%Windir%\\vDll.dll - a copy of Downloader\n\nNote:\n%System% is a variable that refers to the System folder. By default this is C:\\Windows\\System (Windows 95/98/Me), C:\\Winnt\\System32 (Windows NT/2000), or C:\\Windows\\System32 (Windows XP).\n%CurrentFolder% is a variable that refers to the folder where the risk was originally executed.\n\nChecks for the value:\n\n\"auto\" = \"1\"\n\nto the registry subkey:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Soft\\DownloadWWW\n\nand either creates the infection marker or exits if it is found.\n\nAttempts to stop the following service:\n\nKingsoft AntiVirus Service\n\nInjects its DLL component, vDll.dll, into either iexplorer.exe or explorer.exe.\n\nUsing the DLL component, attempts to download a file from the following location:\n\n[http://]www.wowchian.com/dl[2 LETTERS[REMOVED]\n\nSearches for .exe files to infect in all the drives from C to Y.\n\nPrepends itself to any .exe files that it locates on the computer.\n\nThe worm creates the file _desktop.ini in any any directory it has searched for executable files in. This file has the hidden and system attributes set and it stores the date the worm was executed.\n\nDoes not infect .exe files in folders with the following names:\n\nsystem\nsystem32\nwindows\nDocuments and Settings\nSystem Volume Information\nRecycled\nwinnt\nProgram Files\nWindows NT\nWindowsUpdate\nWindows Media Player\nOutlook Express\nInternet Explorer\nComPlus Applications\nNetMeeting\nCommon Files\nMessenger\nMicrosoft Office\nInstallShield Installation Information\nMSN\nMicrosoft Frontpage\nMovie Maker\nMSN Gaming Zone\n\nMay send ICMP packets containing the string \"Hello,World\" to the following IP addresses:\n\n192.168.0.30\n192.168.8.1\n\nMay also send ICMP packets to IP addresses in the same range as the IP address of the compromised computer.\n\nAttempts to open shared folders with the following names, if any computer responds to the ICMP packet:\n\n\\\\ipc$\n\\\\admin$\n\nTries to open the shared folder using administrator as the username and a blank password. It copies itself to that folder, if it succeeds in opening the shared folder.\n\nEnumerates all the computers and shared folders in the local network. The worm uses a blank username and a blank password to open the shared folders.\n\nSearches for and infects .exe files in the shared folders.\n\n\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "tech": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nWhen W32.Madangel is executed, it performs the following actions:\nCreates the following files:\n\n%Windir%\\rundl132.exe - a copy of W32.Madangel\n%Windir%\\Logo1_.exe - a copy of W32.Madangel\n%Windir%\\vDll.dll - a copy of Downloader\n\nNote:\n%System% is a variable that refers to the System folder. By default this is C:\\Windows\\System (Windows 95/98/Me), C:\\Winnt\\System32 (Windows NT/2000), or C:\\Windows\\System32 (Windows XP).\n%CurrentFolder% is a variable that refers to the folder where the risk was originally executed.\n\nChecks for the value:\n\n\"auto\" = \"1\"\n\nto the registry subkey:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Soft\\DownloadWWW\n\nand either creates the infection marker or exits if it is found.\n\nAttempts to stop the following service:\n\nKingsoft AntiVirus Service\n\nInjects its DLL component, vDll.dll, into either iexplorer.exe or explorer.exe.\n\nUsing the DLL component, attempts to download a file from the following location:\n\n[http://]www.wowchian.com/dl[2 LETTERS[REMOVED]\n\nSearches for .exe files to infect in all the drives from C to Y.\n\nPrepends itself to any .exe files that it locates on the computer.\n\nThe worm creates the file _desktop.ini in any any directory it has searched for executable files in. This file has the hidden and system attributes set and it stores the date the worm was executed.\n\nDoes not infect .exe files in folders with the following names:\n\nsystem\nsystem32\nwindows\nDocuments and Settings\nSystem Volume Information\nRecycled\nwinnt\nProgram Files\nWindows NT\nWindowsUpdate\nWindows Media Player\nOutlook Express\nInternet Explorer\nComPlus Applications\nNetMeeting\nCommon Files\nMessenger\nMicrosoft Office\nInstallShield Installation Information\nMSN\nMicrosoft Frontpage\nMovie Maker\nMSN Gaming Zone\n\nMay send ICMP packets containing the string \"Hello,World\" to the following IP addresses:\n\n192.168.0.30\n192.168.8.1\n\nMay also send ICMP packets to IP addresses in the same range as the IP address of the compromised computer.\n\nAttempts to open shared folders with the following names, if any computer responds to the ICMP packet:\n\n\\\\ipc$\n\\\\admin$\n\nTries to open the shared folder using administrator as the username and a blank password. It copies itself to that folder, if it succeeds in opening the shared folder.\n\nEnumerates all the computers and shared folders in the local network. The worm uses a blank username and a blank password to open the shared folders.\n\nSearches for and infects .exe files in the shared folders.\n\n\nRecommendations\nSymantec Security Response encourages all users and administrators to adhere to the following basic security \"best practices\":\nUse a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.\nEnforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.\nEnsure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application.\nDisable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.\nTurn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared.\nTurn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.\nIf a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.\nAlways keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.\nConfigure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.\nIsolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.\nTrain employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.\nIf Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to \"Hidden\" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to \"Unauthorized\", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.\nFor further information on the terms used in this document, please refer to the Security Response glossary.\n",
            "symptoms": "Discovered:\nJuly 6, 2006\nUpdated:\nFebruary 13, 2007 1:01:40 PM\nType:\nWorm\nSystems Affected:\nWindows\n\nThe following instructions pertain to all current and recent Symantec antivirus products, including the Symantec AntiVirus and Norton AntiVirus product lines.\nDisable System Restore (Windows Me/XP).\nUpdate the virus definitions.\nRun a full system scan.\nFor specific details on each of these steps, read the following instructions.\n\n1. To disable System Restore (Windows Me/XP)\nIf you are running Windows Me or Windows XP, we recommend that you temporarily turn off System Restore. Windows Me/XP uses this feature, which is enabled by default, to restore the files on your computer in case they become damaged. If a virus, worm, or Trojan infects a computer, System Restore may back up the virus, worm, or Trojan on the computer.\n\nWindows prevents outside programs, including antivirus programs, from modifying System Restore. Therefore, antivirus programs or tools cannot remove threats in the System Restore folder. As a result, System Restore has the potential of restoring an infected file on your computer, even after you have cleaned the infected files from all the other locations.\n\nAlso, a virus scan may detect a threat in the System Restore folder even though you have removed the threat.\n\nFor instructions on how to turn off System Restore, read your Windows documentation, or one of the following articles:\nHow to disable or enable Windows Me System Restore\nHow to turn off or turn on Windows XP System Restore\n\nNote: When you are completely finished with the removal procedure and are satisfied that the threat has been removed, reenable System Restore by following the instructions in the aforementioned documents.\n\nFor additional information, and an alternative to disabling Windows Me System Restore, see the Microsoft Knowledge Base article: Antivirus Tools Cannot Clean Infected Files in the _Restore Folder (Article ID: Q263455).\n\n2. To update the virus definitions\nSymantec Security Response fully tests all the virus definitions for quality assurance before they are posted to our servers. There are two ways to obtain the most recent virus definitions:\nRunning LiveUpdate, which is the easiest way to obtain virus definitions:\nIf you use Norton AntiVirus 2006, Symantec AntiVirus Corporate Edition 10.0, or newer products, LiveUpdate definitions are updated daily. These products include newer technology.\nIf you use Norton AntiVirus 2005, Symantec AntiVirus Corporate Edition 9.0, or earlier products, LiveUpdate definitions are updated weekly. The exception is major outbreaks, when definitions are updated more often.\nDownloading the definitions using the Intelligent Updater: The Intelligent Updater virus definitions are posted daily. You should download the definitions from the Symantec Security Response Web site and manually install them. To determine whether definitions for this threat are available by the Intelligent Updater, refer to Virus Definitions (Intelligent Updater).\n\nThe latest Intelligent Updater virus definitions can be obtained here: Intelligent Updater virus definitions. For detailed instructions read the document: How to update virus definition files using the Intelligent Updater.\n\n3. To run a full system scan\nStart your Symantec antivirus program and make sure that it is configured to scan all the files.\nFor Norton AntiVirus consumer products: Read the document: How to configure Norton AntiVirus to scan all files.\nFor Symantec AntiVirus Enterprise products: Read the document: How to verify that a Symantec Corporate antivirus product is set to scan all files.\nRun a full system scan.\nIf any files are detected, follow the instructions displayed by your antivirus program.\n\nImportant: If you are unable to start your Symantec antivirus product or the product reports that it cannot delete a detected file, you may need to stop the risk from running in order to remove it. To do this, run the scan in Safe mode. For instructions, read the document, How to start the computer in Safe Mode. Once you have restarted in Safe mode, run the scan again.\n\nAfter the files are deleted, restart the computer in Normal mode.\n\n\n"
        }
    ]
}